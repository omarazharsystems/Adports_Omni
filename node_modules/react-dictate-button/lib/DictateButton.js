"use strict";

var _typeof = require("@babel/runtime-corejs3/helpers/typeof");

var _WeakMap = require("@babel/runtime-corejs3/core-js-stable/weak-map");

var _Object$defineProperty = require("@babel/runtime-corejs3/core-js-stable/object/define-property");

var _Object$getOwnPropertyDescriptor = require("@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor");

var _interopRequireDefault = require("@babel/runtime-corejs3/helpers/interopRequireDefault");

_Object$defineProperty(exports, "__esModule", {
  value: true
});

exports["default"] = void 0;

var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime-corejs3/helpers/slicedToArray"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireWildcard(require("react"));

var _Composer = _interopRequireDefault(require("./Composer"));

var _useReadyState3 = _interopRequireDefault(require("./hooks/useReadyState"));

var _useRefFrom = _interopRequireDefault(require("./useRefFrom"));

var _useSupported3 = _interopRequireDefault(require("./hooks/useSupported"));

function _getRequireWildcardCache(nodeInterop) { if (typeof _WeakMap !== "function") return null; var cacheBabelInterop = new _WeakMap(); var cacheNodeInterop = new _WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { "default": obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = _Object$defineProperty && _Object$getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? _Object$getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { _Object$defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj["default"] = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

/* eslint no-magic-numbers: ["error", { "ignore": [0, 1, 2, 3] }] */
var DictateButtonCore = function DictateButtonCore(_ref) {
  var children = _ref.children,
      className = _ref.className,
      disabled = _ref.disabled,
      onClick = _ref.onClick;

  var _useReadyState = (0, _useReadyState3["default"])(),
      _useReadyState2 = (0, _slicedToArray2["default"])(_useReadyState, 1),
      readyState = _useReadyState2[0];

  var _useSupported = (0, _useSupported3["default"])(),
      _useSupported2 = (0, _slicedToArray2["default"])(_useSupported, 1),
      supported = _useSupported2[0];

  return /*#__PURE__*/_react["default"].createElement("button", {
    className: className,
    disabled: readyState === 1 || readyState === 3 || !supported || disabled,
    onClick: onClick,
    type: "button"
  }, typeof children === 'function' ? children({
    readyState: readyState
  }) : children);
};

DictateButtonCore.defaultProps = {
  children: undefined,
  className: undefined,
  disabled: undefined
};
DictateButtonCore.propTypes = {
  children: _propTypes["default"].any,
  className: _propTypes["default"].string,
  disabled: _propTypes["default"].bool,
  onClick: _propTypes["default"].func.isRequired
};

var DictateButton = function DictateButton(_ref2) {
  var children = _ref2.children,
      className = _ref2.className,
      disabled = _ref2.disabled,
      extra = _ref2.extra,
      grammar = _ref2.grammar,
      lang = _ref2.lang,
      onClick = _ref2.onClick,
      onDictate = _ref2.onDictate,
      onError = _ref2.onError,
      onProgress = _ref2.onProgress,
      onRawEvent = _ref2.onRawEvent,
      speechGrammarList = _ref2.speechGrammarList,
      speechRecognition = _ref2.speechRecognition;

  var _useState = (0, _react.useState)(),
      _useState2 = (0, _slicedToArray2["default"])(_useState, 2),
      started = _useState2[0],
      setStarted = _useState2[1];

  var onClickRef = (0, _useRefFrom["default"])(onClick);
  var onDictateRef = (0, _useRefFrom["default"])(onDictate);
  var onErrorRef = (0, _useRefFrom["default"])(onError);
  var handleClick = (0, _react.useCallback)(function (event) {
    onClickRef.current && onClickRef.current(event);
    !event.isDefaultPrevented() && setStarted(function (started) {
      return !started;
    });
  }, [onClickRef, setStarted]);
  var handleDictate = (0, _react.useCallback)(function (event) {
    setStarted(false);
    onDictateRef.current && onDictateRef.current(event);
  }, [onDictateRef, setStarted]);
  var handleError = (0, _react.useCallback)(function (event) {
    setStarted(false);
    onErrorRef.current && onErrorRef.current(event);
  }, [onErrorRef, setStarted]);
  return /*#__PURE__*/_react["default"].createElement(_Composer["default"], {
    extra: extra,
    grammar: grammar,
    lang: lang,
    onDictate: handleDictate,
    onError: handleError,
    onProgress: onProgress,
    onRawEvent: onRawEvent,
    speechGrammarList: speechGrammarList,
    speechRecognition: speechRecognition,
    started: started && !disabled
  }, /*#__PURE__*/_react["default"].createElement(DictateButtonCore, {
    className: className,
    disabled: disabled,
    onClick: handleClick
  }, children));
};

DictateButton.defaultProps = {
  children: undefined,
  className: undefined,
  disabled: undefined,
  extra: undefined,
  grammar: undefined,
  lang: undefined,
  onClick: undefined,
  onDictate: undefined,
  onError: undefined,
  onProgress: undefined,
  onRawEvent: undefined,
  speechGrammarList: undefined,
  speechRecognition: undefined
};
DictateButton.propTypes = {
  children: _propTypes["default"].any,
  className: _propTypes["default"].string,
  disabled: _propTypes["default"].bool,
  extra: _propTypes["default"].any,
  grammar: _propTypes["default"].string,
  lang: _propTypes["default"].string,
  onClick: _propTypes["default"].func,
  onDictate: _propTypes["default"].func,
  onError: _propTypes["default"].func,
  onProgress: _propTypes["default"].func,
  onRawEvent: _propTypes["default"].func,
  speechGrammarList: _propTypes["default"].any,
  speechRecognition: _propTypes["default"].any
};
var _default = DictateButton;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9EaWN0YXRlQnV0dG9uLmpzIl0sIm5hbWVzIjpbIkRpY3RhdGVCdXR0b25Db3JlIiwiY2hpbGRyZW4iLCJjbGFzc05hbWUiLCJkaXNhYmxlZCIsIm9uQ2xpY2siLCJyZWFkeVN0YXRlIiwic3VwcG9ydGVkIiwiZGVmYXVsdFByb3BzIiwidW5kZWZpbmVkIiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwiYW55Iiwic3RyaW5nIiwiYm9vbCIsImZ1bmMiLCJpc1JlcXVpcmVkIiwiRGljdGF0ZUJ1dHRvbiIsImV4dHJhIiwiZ3JhbW1hciIsImxhbmciLCJvbkRpY3RhdGUiLCJvbkVycm9yIiwib25Qcm9ncmVzcyIsIm9uUmF3RXZlbnQiLCJzcGVlY2hHcmFtbWFyTGlzdCIsInNwZWVjaFJlY29nbml0aW9uIiwic3RhcnRlZCIsInNldFN0YXJ0ZWQiLCJvbkNsaWNrUmVmIiwib25EaWN0YXRlUmVmIiwib25FcnJvclJlZiIsImhhbmRsZUNsaWNrIiwiZXZlbnQiLCJjdXJyZW50IiwiaXNEZWZhdWx0UHJldmVudGVkIiwiaGFuZGxlRGljdGF0ZSIsImhhbmRsZUVycm9yIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUVBOztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOzs7Ozs7QUFSQTtBQVVBLElBQU1BLGlCQUFpQixHQUFHLFNBQXBCQSxpQkFBb0IsT0FBZ0Q7QUFBQSxNQUE3Q0MsUUFBNkMsUUFBN0NBLFFBQTZDO0FBQUEsTUFBbkNDLFNBQW1DLFFBQW5DQSxTQUFtQztBQUFBLE1BQXhCQyxRQUF3QixRQUF4QkEsUUFBd0I7QUFBQSxNQUFkQyxPQUFjLFFBQWRBLE9BQWM7O0FBQ3hFLHVCQUFxQixpQ0FBckI7QUFBQTtBQUFBLE1BQU9DLFVBQVA7O0FBQ0Esc0JBQW9CLGdDQUFwQjtBQUFBO0FBQUEsTUFBT0MsU0FBUDs7QUFFQSxzQkFDRTtBQUNFLElBQUEsU0FBUyxFQUFFSixTQURiO0FBRUUsSUFBQSxRQUFRLEVBQUVH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RUFBQUEsUUFBUSxFQUFFUyxzQkFBVUMsR0FESTtBQUV4QlQsRUFBQUEsU0FBUyxFQUFFUSxzQkFBVUUsTUFGRztBQUd4QlQsRUFBQUEsUUFBUSxFQUFFTyxzQkFBVUcsSUFISTtBQUl4QkksRUFBQUEsS0FBSyxFQUFFUCxzQkFBVUMsR0FKTztBQUt4Qk8sRUFBQUEsT0FBTyxFQUFFUixzQkFBVUUsTUFMSztBQU14Qk8sRUFBQUEsSUFBSSxFQUFFVCxzQkFBVUUsTUFOUTtBQU94QlIsRUFBQUEsT0FBTyxFQUFFTSxzQkFBVUksSUFQSztBQVF4Qk0sRUFBQUEsU0FBUyxFQUFFVixzQkFBVUksSUFSRztBQVN4Qk8sRUFBQUEsT0FBTyxFQUFFWCxzQkFBVUksSUFUSztBQVV4QlEsRUFBQUEsVUFBVSxFQUFFWixzQkFBVUksSUFWRTtBQVd4QlMsRUFBQUEsVUFBVSxFQUFFYixzQkFBVUksSUFYRTtBQVl4QlUsRUFBQUEsaUJBQWlCLEVBQUVkLHNCQUFVQyxHQVpMO0FBYXhCYyxFQUFBQSxpQkFBaUIsRUFBRWYsc0JBQVVDO0FBYkwsQ0FBMUI7ZUFnQmVLLGEiLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQgbm8tbWFnaWMtbnVtYmVyczogW1wiZXJyb3JcIiwgeyBcImlnbm9yZVwiOiBbMCwgMSwgMiwgM10gfV0gKi9cblxuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBSZWFjdCwgeyB1c2VDYWxsYmFjaywgdXNlU3RhdGUgfSBmcm9tICdyZWFjdCc7XG5cbmltcG9ydCBDb21wb3NlciBmcm9tICcuL0NvbXBvc2VyJztcbmltcG9ydCB1c2VSZWFkeVN0YXRlIGZyb20gJy4vaG9va3MvdXNlUmVhZHlTdGF0ZSc7XG5pbXBvcnQgdXNlUmVmRnJvbSBmcm9tICcuL3VzZVJlZkZyb20nO1xuaW1wb3J0IHVzZVN1cHBvcnRlZCBmcm9tICcuL2hvb2tzL3VzZVN1cHBvcnRlZCc7XG5cbmNvbnN0IERpY3RhdGVCdXR0b25Db3JlID0gKHsgY2hpbGRyZW4sIGNsYXNzTmFtZSwgZGlzYWJsZWQsIG9uQ2xpY2sgfSkgPT4ge1xuICBjb25zdCBbcmVhZHlTdGF0ZV0gPSB1c2VSZWFkeVN0YXRlKCk7XG4gIGNvbnN0IFtzdXBwb3J0ZWRdID0gdXNlU3VwcG9ydGVkKCk7XG5cbiAgcmV0dXJuIChcbiAgICA8YnV0dG9uXG4gICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZX1cbiAgICAgIGRpc2FibGVkPXtyZWFkeVN0YXRlID09PSAxIHx8IHJlYWR5U3RhdGUgPT09IDMgfHwgIXN1cHBvcnRlZCB8fCBkaXNhYmxlZH1cbiAgICAgIG9uQ2xpY2s9e29uQ2xpY2t9XG4gICAgICB0eXBlPVwiYnV0dG9uXCJcbiAgICA+XG4gICAgICB7dHlwZW9mIGNoaWxkcmVuID09PSAnZnVuY3Rpb24nID8gY2hpbGRyZW4oeyByZWFkeVN0YXRlIH0pIDogY2hpbGRyZW59XG4gICAgPC9idXR0b24+XG4gICk7XG59O1xuXG5EaWN0YXRlQnV0dG9uQ29yZS5kZWZhdWx0UHJvcHMgPSB7XG4gIGNoaWxkcmVuOiB1bmRlZmluZWQsXG4gIGNsYXNzTmFtZTogdW5kZWZpbmVkLFxuICBkaXNhYmxlZDogdW5kZWZpbmVkXG59O1xuXG5EaWN0YXRlQnV0dG9uQ29yZS5wcm9wVHlwZXMgPSB7XG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LFxuICBjbGFzc05hbWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGRpc2FibGVkOiBQcm9wVHlwZXMuYm9vbCxcbiAgb25DbGljazogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZFxufTtcblxuY29uc3QgRGljdGF0ZUJ1dHRvbiA9ICh7XG4gIGNoaWxkcmVuLFxuICBjbGFzc05hbWUsXG4gIGRpc2FibGVkLFxuICBleHRyYSxcbiAgZ3JhbW1hcixcbiAgbGFuZyxcbiAgb25DbGljayxcbiAgb25EaWN0YXRlLFxuICBvbkVycm9yLFxuICBvblByb2dyZXNzLFxuICBvblJhd0V2ZW50LFxuICBzcGVlY2hHcmFtbWFyTGlzdCxcbiAgc3BlZWNoUmVjb2duaXRpb25cbn0pID0+IHtcbiAgY29uc3QgW3N0YXJ0ZWQsIHNldFN0YXJ0ZWRdID0gdXNlU3RhdGUoKTtcbiAgY29uc3Qgb25DbGlja1JlZiA9IHVzZVJlZkZyb20ob25DbGljayk7XG4gIGNvbnN0IG9uRGljdGF0ZVJlZiA9IHVzZVJlZkZyb20ob25EaWN0YXRlKTtcbiAgY29uc3Qgb25FcnJvclJlZiA9IHVzZVJlZkZyb20ob25FcnJvcik7XG5cbiAgY29uc3QgaGFuZGxlQ2xpY2sgPSB1c2VDYWxsYmFjayhcbiAgICBldmVudCA9PiB7XG4gICAgICBvbkNsaWNrUmVmLmN1cnJlbnQgJiYgb25DbGlja1JlZi5jdXJyZW50KGV2ZW50KTtcblxuICAgICAgIWV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpICYmIHNldFN0YXJ0ZWQoc3RhcnRlZCA9PiAhc3RhcnRlZCk7XG4gICAgfSxcbiAgICBbb25DbGlja1JlZiwgc2V0U3RhcnRlZF1cbiAgKTtcblxuICBjb25zdCBoYW5kbGVEaWN0YXRlID0gdXNlQ2FsbGJhY2soXG4gICAgZXZlbnQgPT4ge1xuICAgICAgc2V0U3RhcnRlZChmYWxzZSk7XG5cbiAgICAgIG9uRGljdGF0ZVJlZi5jdXJyZW50ICYmIG9uRGljdGF0ZVJlZi5jdXJyZW50KGV2ZW50KTtcbiAgICB9LFxuICAgIFtvbkRpY3RhdGVSZWYsIHNldFN0YXJ0ZWRdXG4gICk7XG5cbiAgY29uc3QgaGFuZGxlRXJyb3IgPSB1c2VDYWxsYmFjayhcbiAgICBldmVudCA9PiB7XG4gICAgICBzZXRTdGFydGVkKGZhbHNlKTtcblxuICAgICAgb25FcnJvclJlZi5jdXJyZW50ICYmIG9uRXJyb3JSZWYuY3VycmVudChldmVudCk7XG4gICAgfSxcbiAgICBbb25FcnJvclJlZiwgc2V0U3RhcnRlZF1cbiAgKTtcblxuICByZXR1cm4gKFxuICAgIDxDb21wb3NlclxuICAgICAgZXh0cmE9e2V4dHJhfVxuICAgICAgZ3JhbW1hcj17Z3JhbW1hcn1cbiAgICAgIGxhbmc9e2xhbmd9XG4gICAgICBvbkRpY3RhdGU9e2hhbmRsZURpY3RhdGV9XG4gICAgICBvbkVycm9yPXtoYW5kbGVFcnJvcn1cbiAgICAgIG9uUHJvZ3Jlc3M9e29uUHJvZ3Jlc3N9XG4gICAgICBvblJhd0V2ZW50PXtvblJhd0V2ZW50fVxuICAgICAgc3BlZWNoR3JhbW1hckxpc3Q9e3NwZWVjaEdyYW1tYXJMaXN0fVxuICAgICAgc3BlZWNoUmVjb2duaXRpb249e3NwZWVjaFJlY29nbml0aW9ufVxuICAgICAgc3RhcnRlZD17c3RhcnRlZCAmJiAhZGlzYWJsZWR9XG4gICAgPlxuICAgICAgPERpY3RhdGVCdXR0b25Db3JlIGNsYXNzTmFtZT17Y2xhc3NOYW1lfSBkaXNhYmxlZD17ZGlzYWJsZWR9IG9uQ2xpY2s9e2hhbmRsZUNsaWNrfT5cbiAgICAgICAge2NoaWxkcmVufVxuICAgICAgPC9EaWN0YXRlQnV0dG9uQ29yZT5cbiAgICA8L0NvbXBvc2VyPlxuICApO1xufTtcblxuRGljdGF0ZUJ1dHRvbi5kZWZhdWx0UHJvcHMgPSB7XG4gIGNoaWxkcmVuOiB1bmRlZmluZWQsXG4gIGNsYXNzTmFtZTogdW5kZWZpbmVkLFxuICBkaXNhYmxlZDogdW5kZWZpbmVkLFxuICBleHRyYTogdW5kZWZpbmVkLFxuICBncmFtbWFyOiB1bmRlZmluZWQsXG4gIGxhbmc6IHVuZGVmaW5lZCxcbiAgb25DbGljazogdW5kZWZpbmVkLFxuICBvbkRpY3RhdGU6IHVuZGVmaW5lZCxcbiAgb25FcnJvcjogdW5kZWZpbmVkLFxuICBvblByb2dyZXNzOiB1bmRlZmluZWQsXG4gIG9uUmF3RXZlbnQ6IHVuZGVmaW5lZCxcbiAgc3BlZWNoR3JhbW1hckxpc3Q6IHVuZGVmaW5lZCxcbiAgc3BlZWNoUmVjb2duaXRpb246IHVuZGVmaW5lZFxufTtcblxuRGljdGF0ZUJ1dHRvbi5wcm9wVHlwZXMgPSB7XG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMuYW55LFxuICBjbGFzc05hbWU6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGRpc2FibGVkOiBQcm9wVHlwZXMuYm9vbCxcbiAgZXh0cmE6IFByb3BUeXBlcy5hbnksXG4gIGdyYW1tYXI6IFByb3BUeXBlcy5zdHJpbmcsXG4gIGxhbmc6IFByb3BUeXBlcy5zdHJpbmcsXG4gIG9uQ2xpY2s6IFByb3BUeXBlcy5mdW5jLFxuICBvbkRpY3RhdGU6IFByb3BUeXBlcy5mdW5jLFxuICBvbkVycm9yOiBQcm9wVHlwZXMuZnVuYyxcbiAgb25Qcm9ncmVzczogUHJvcFR5cGVzLmZ1bmMsXG4gIG9uUmF3RXZlbnQ6IFByb3BUeXBlcy5mdW5jLFxuICBzcGVlY2hHcmFtbWFyTGlzdDogUHJvcFR5cGVzLmFueSxcbiAgc3BlZWNoUmVjb2duaXRpb246IFByb3BUeXBlcy5hbnlcbn07XG5cbmV4cG9ydCBkZWZhdWx0IERpY3RhdGVCdXR0b247XG4iXX0=