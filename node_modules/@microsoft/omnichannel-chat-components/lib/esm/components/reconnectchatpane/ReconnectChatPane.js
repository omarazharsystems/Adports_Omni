import { DefaultButton, Icon, Label, Stack } from "@fluentui/react";
import React, { useCallback } from "react";
import { BroadcastService } from "../../services/BroadcastService";
import { ElementType, EventNames } from "../../common/Constants";
import { KeyCodes } from "../../common/Constants";
import { decodeComponentString } from "../../common/decodeComponentString";
import { defaultReconnectChatPaneButtonGroupStyles } from "./common/default/defaultStyles/defaultReconnectChatPaneButtonGroupStyles";
import { defaultReconnectChatPaneContinueChatButtonHoveredStyles } from "./common/default/defaultStyles/defaultReconnectChatPaneContinueChatButtonHoveredStyles";
import { defaultReconnectChatPaneContinueChatButtonStyles } from "./common/default/defaultStyles/defaultReconnectChatPaneContinueChatButtonStyles";
import { defaultReconnectChatPaneControlProps } from "./common/default/defaultProps/defaultReconnectChatPaneControlProps";
import { defaultReconnectChatPaneGeneralStyles } from "./common/default/defaultStyles/defaultReconnectChatPaneGeneralStyles";
import { defaultReconnectChatPaneIconStyles } from "./common/default/defaultStyles/defaultReconnectChatPaneIconStyles";
import { defaultReconnectChatPaneStartNewChatButtonHoveredStyles } from "./common/default/defaultStyles/defaultReconnectChatPaneStartNewChatButtonHoveredStyles";
import { defaultReconnectChatPaneStartNewChatButtonStyles } from "./common/default/defaultStyles/defaultReconnectChatPaneStartNewChatButtonStyles";
import { defaultReconnectChatPaneSubtitleStyles } from "./common/default/defaultStyles/defaultReconnectChatPaneSubtitleStyles";
import { defaultReconnectChatPaneTitleStyles } from "./common/default/defaultStyles/defaultReconnectChatPaneTitleStyles";
import { defaultReconnectChatPaneWrapperStyles } from "./common/default/defaultStyles/defaultReconnectChatPaneWrapperStyles";

function ReconnectChatPane(props) {
  var _props$controlProps, _props$styleProps, _props$styleProps2, _props$styleProps3, _props$styleProps4, _props$styleProps5, _props$styleProps6, _props$styleProps7, _props$styleProps8, _props$styleProps9, _props$styleProps10, _props$styleProps11, _props$styleProps12, _props$controlProps8, _props$styleProps13, _props$styleProps13$c, _props$controlProps9, _props$controlProps10, _props$styleProps14, _props$styleProps14$c, _props$controlProps11, _props$componentOverr, _props$styleProps15, _props$styleProps15$c, _props$controlProps12, _props$controlProps13, _props$componentOverr2, _props$styleProps16, _props$styleProps16$c, _props$controlProps14, _props$controlProps15, _props$componentOverr3, _props$styleProps17, _props$styleProps17$c, _props$controlProps16, _props$controlProps17, _props$styleProps18, _props$styleProps18$c, _props$controlProps18, _props$componentOverr4, _props$styleProps19, _props$styleProps19$c, _props$controlProps19, _props$controlProps20, _props$controlProps21, _props$componentOverr5, _props$styleProps20, _props$styleProps20$c, _props$controlProps22, _props$controlProps23;

  const elementId = ((_props$controlProps = props.controlProps) === null || _props$controlProps === void 0 ? void 0 : _props$controlProps.id) ?? defaultReconnectChatPaneControlProps.id;
  const handleContinueChatClick = useCallback(() => {
    var _props$controlProps2;

    if ((_props$controlProps2 = props.controlProps) !== null && _props$controlProps2 !== void 0 && _props$controlProps2.onContinueChat) {
      var _props$controlProps3;

      const customEvent = {
        elementType: ElementType.ReconnectChatContinueChatButton,
        elementId: elementId + "-continueconversationbutton",
        eventName: EventNames.OnClick
      };
      BroadcastService.postMessage(customEvent);
      (_props$controlProps3 = props.controlProps) === null || _props$controlProps3 === void 0 ? void 0 : _props$controlProps3.onContinueChat();
    }
  }, []);
  const handleStartNewChatClick = useCallback(() => {
    var _props$controlProps4;

    if ((_props$controlProps4 = props.controlProps) !== null && _props$controlProps4 !== void 0 && _props$controlProps4.onStartNewChat) {
      var _props$controlProps5;

      const customEvent = {
        elementType: ElementType.ReconnectChatStartNewChatButton,
        elementId: elementId + "-startnewconversationbutton",
        eventName: EventNames.OnClick
      };
      BroadcastService.postMessage(customEvent);
      (_props$controlProps5 = props.controlProps) === null || _props$controlProps5 === void 0 ? void 0 : _props$controlProps5.onStartNewChat();
    }
  }, []); // eslint-disable-next-line @typescript-eslint/no-explicit-any

  const handleEscKeyDown = useCallback(e => {
    var _props$controlProps6;

    if (e.code === KeyCodes.ESCAPE && (_props$controlProps6 = props.controlProps) !== null && _props$controlProps6 !== void 0 && _props$controlProps6.onMinimize) {
      var _props$controlProps7;

      const customEvent = {
        elementType: ElementType.ReconnectChatPane,
        elementId: elementId,
        eventName: EventNames.OnEscapeKeyDown
      };
      BroadcastService.postMessage(customEvent);
      (_props$controlProps7 = props.controlProps) === null || _props$controlProps7 === void 0 ? void 0 : _props$controlProps7.onMinimize();
    }
  }, []);
  const containerStyles = {
    root: Object.assign({}, defaultReconnectChatPaneGeneralStyles, (_props$styleProps = props.styleProps) === null || _props$styleProps === void 0 ? void 0 : _props$styleProps.generalStyleProps)
  };
  const wrapperStyles = {
    root: Object.assign({}, defaultReconnectChatPaneWrapperStyles, (_props$styleProps2 = props.styleProps) === null || _props$styleProps2 === void 0 ? void 0 : _props$styleProps2.wrapperStyleProps)
  };
  const titleStyles = {
    root: Object.assign({}, defaultReconnectChatPaneTitleStyles, (_props$styleProps3 = props.styleProps) === null || _props$styleProps3 === void 0 ? void 0 : _props$styleProps3.titleStyleProps)
  };
  const subtitleStyles = {
    root: Object.assign({}, defaultReconnectChatPaneSubtitleStyles, (_props$styleProps4 = props.styleProps) === null || _props$styleProps4 === void 0 ? void 0 : _props$styleProps4.subtitleStyleProps)
  };
  const iconStyles = {
    root: Object.assign({}, defaultReconnectChatPaneIconStyles, (_props$styleProps5 = props.styleProps) === null || _props$styleProps5 === void 0 ? void 0 : _props$styleProps5.iconStyleProps)
  };
  const buttonGroupStyles = {
    root: Object.assign({}, defaultReconnectChatPaneButtonGroupStyles, (_props$styleProps6 = props.styleProps) === null || _props$styleProps6 === void 0 ? void 0 : _props$styleProps6.buttonGroupStyleProps)
  };
  const continueChatButtonStyles = {
    root: Object.assign({}, defaultReconnectChatPaneContinueChatButtonStyles, (_props$styleProps7 = props.styleProps) === null || _props$styleProps7 === void 0 ? void 0 : _props$styleProps7.continueChatButtonStyleProps),
    rootHovered: Object.assign({}, defaultReconnectChatPaneContinueChatButtonHoveredStyles, (_props$styleProps8 = props.styleProps) === null || _props$styleProps8 === void 0 ? void 0 : _props$styleProps8.continueChatButtonHoveredStyleProps),
    rootPressed: Object.assign({}, defaultReconnectChatPaneContinueChatButtonHoveredStyles, (_props$styleProps9 = props.styleProps) === null || _props$styleProps9 === void 0 ? void 0 : _props$styleProps9.continueChatButtonHoveredStyleProps)
  };
  const startNewChatButtonStyles = {
    root: Object.assign({}, defaultReconnectChatPaneStartNewChatButtonStyles, (_props$styleProps10 = props.styleProps) === null || _props$styleProps10 === void 0 ? void 0 : _props$styleProps10.startNewChatButtonStyleProps),
    rootHovered: Object.assign({}, defaultReconnectChatPaneStartNewChatButtonHoveredStyles, (_props$styleProps11 = props.styleProps) === null || _props$styleProps11 === void 0 ? void 0 : _props$styleProps11.startNewChatButtonHoveredStyleProps),
    rootPressed: Object.assign({}, defaultReconnectChatPaneStartNewChatButtonHoveredStyles, (_props$styleProps12 = props.styleProps) === null || _props$styleProps12 === void 0 ? void 0 : _props$styleProps12.startNewChatButtonHoveredStyleProps)
  };
  return /*#__PURE__*/React.createElement(React.Fragment, null, !((_props$controlProps8 = props.controlProps) !== null && _props$controlProps8 !== void 0 && _props$controlProps8.hideReconnectChatPane) && /*#__PURE__*/React.createElement(Stack, {
    className: (_props$styleProps13 = props.styleProps) === null || _props$styleProps13 === void 0 ? void 0 : (_props$styleProps13$c = _props$styleProps13.classNames) === null || _props$styleProps13$c === void 0 ? void 0 : _props$styleProps13$c.containerClassName,
    id: elementId,
    tabIndex: -1,
    onKeyDown: handleEscKeyDown,
    dir: ((_props$controlProps9 = props.controlProps) === null || _props$controlProps9 === void 0 ? void 0 : _props$controlProps9.dir) || defaultReconnectChatPaneControlProps.dir,
    "aria-label": ((_props$controlProps10 = props.controlProps) === null || _props$controlProps10 === void 0 ? void 0 : _props$controlProps10.reconnectChatPaneAriaLabel) || defaultReconnectChatPaneControlProps.reconnectChatPaneAriaLabel,
    styles: containerStyles
  }, /*#__PURE__*/React.createElement(Stack, {
    className: (_props$styleProps14 = props.styleProps) === null || _props$styleProps14 === void 0 ? void 0 : (_props$styleProps14$c = _props$styleProps14.classNames) === null || _props$styleProps14$c === void 0 ? void 0 : _props$styleProps14$c.wrapperClassName,
    styles: wrapperStyles,
    tabIndex: -1,
    id: elementId + "-wrapper"
  }, !((_props$controlProps11 = props.controlProps) !== null && _props$controlProps11 !== void 0 && _props$controlProps11.hideTitle) && (decodeComponentString((_props$componentOverr = props.componentOverrides) === null || _props$componentOverr === void 0 ? void 0 : _props$componentOverr.title) || /*#__PURE__*/React.createElement(Label, {
    className: (_props$styleProps15 = props.styleProps) === null || _props$styleProps15 === void 0 ? void 0 : (_props$styleProps15$c = _props$styleProps15.classNames) === null || _props$styleProps15$c === void 0 ? void 0 : _props$styleProps15$c.titleClassName,
    styles: titleStyles,
    tabIndex: -1,
    id: elementId + "-title"
  }, ((_props$controlProps12 = props.controlProps) === null || _props$controlProps12 === void 0 ? void 0 : _props$controlProps12.titleText) || defaultReconnectChatPaneControlProps.titleText)), !((_props$controlProps13 = props.controlProps) !== null && _props$controlProps13 !== void 0 && _props$controlProps13.hideSubtitle) && (decodeComponentString((_props$componentOverr2 = props.componentOverrides) === null || _props$componentOverr2 === void 0 ? void 0 : _props$componentOverr2.subtitle) || /*#__PURE__*/React.createElement(Label, {
    className: (_props$styleProps16 = props.styleProps) === null || _props$styleProps16 === void 0 ? void 0 : (_props$styleProps16$c = _props$styleProps16.classNames) === null || _props$styleProps16$c === void 0 ? void 0 : _props$styleProps16$c.subtitleClassName,
    styles: subtitleStyles,
    tabIndex: -1,
    id: elementId + "-subtitle"
  }, ((_props$controlProps14 = props.controlProps) === null || _props$controlProps14 === void 0 ? void 0 : _props$controlProps14.subtitleText) || defaultReconnectChatPaneControlProps.subtitleText)), !((_props$controlProps15 = props.controlProps) !== null && _props$controlProps15 !== void 0 && _props$controlProps15.hideIcon) && (decodeComponentString((_props$componentOverr3 = props.componentOverrides) === null || _props$componentOverr3 === void 0 ? void 0 : _props$componentOverr3.icon) || /*#__PURE__*/React.createElement(Icon, {
    className: (_props$styleProps17 = props.styleProps) === null || _props$styleProps17 === void 0 ? void 0 : (_props$styleProps17$c = _props$styleProps17.classNames) === null || _props$styleProps17$c === void 0 ? void 0 : _props$styleProps17$c.iconClassName,
    styles: iconStyles,
    tabIndex: -1,
    role: "img",
    id: elementId + "-icon",
    "aria-label": ((_props$controlProps16 = props.controlProps) === null || _props$controlProps16 === void 0 ? void 0 : _props$controlProps16.iconAriaLabel) || defaultReconnectChatPaneControlProps.iconAriaLabel
  })), /*#__PURE__*/React.createElement(Stack, {
    horizontal: ((_props$controlProps17 = props.controlProps) === null || _props$controlProps17 === void 0 ? void 0 : _props$controlProps17.isButtonGroupHorizontal) || defaultReconnectChatPaneControlProps.isButtonGroupHorizontal,
    className: (_props$styleProps18 = props.styleProps) === null || _props$styleProps18 === void 0 ? void 0 : (_props$styleProps18$c = _props$styleProps18.classNames) === null || _props$styleProps18$c === void 0 ? void 0 : _props$styleProps18$c.buttonGroupClassName,
    styles: buttonGroupStyles,
    tabIndex: -1,
    id: elementId + "-buttongroup"
  }, !((_props$controlProps18 = props.controlProps) !== null && _props$controlProps18 !== void 0 && _props$controlProps18.hideContinueChatButton) && (decodeComponentString((_props$componentOverr4 = props.componentOverrides) === null || _props$componentOverr4 === void 0 ? void 0 : _props$componentOverr4.continueChatButton) || /*#__PURE__*/React.createElement(DefaultButton, {
    className: (_props$styleProps19 = props.styleProps) === null || _props$styleProps19 === void 0 ? void 0 : (_props$styleProps19$c = _props$styleProps19.classNames) === null || _props$styleProps19$c === void 0 ? void 0 : _props$styleProps19$c.continueChatButtonClassName,
    styles: continueChatButtonStyles,
    tabIndex: 0,
    text: ((_props$controlProps19 = props.controlProps) === null || _props$controlProps19 === void 0 ? void 0 : _props$controlProps19.continueChatButtonText) || defaultReconnectChatPaneControlProps.continueChatButtonText,
    onClick: handleContinueChatClick,
    id: elementId + "-continueconversationbutton",
    "aria-label": ((_props$controlProps20 = props.controlProps) === null || _props$controlProps20 === void 0 ? void 0 : _props$controlProps20.continueChatButtonAriaLabel) || defaultReconnectChatPaneControlProps.continueChatButtonAriaLabel
  })), !((_props$controlProps21 = props.controlProps) !== null && _props$controlProps21 !== void 0 && _props$controlProps21.hideStartNewChatButton) && (decodeComponentString((_props$componentOverr5 = props.componentOverrides) === null || _props$componentOverr5 === void 0 ? void 0 : _props$componentOverr5.startNewChatButton) || /*#__PURE__*/React.createElement(DefaultButton, {
    className: (_props$styleProps20 = props.styleProps) === null || _props$styleProps20 === void 0 ? void 0 : (_props$styleProps20$c = _props$styleProps20.classNames) === null || _props$styleProps20$c === void 0 ? void 0 : _props$styleProps20$c.startNewChatButtonClassName,
    styles: startNewChatButtonStyles,
    tabIndex: 0,
    text: ((_props$controlProps22 = props.controlProps) === null || _props$controlProps22 === void 0 ? void 0 : _props$controlProps22.startNewChatButtonText) || defaultReconnectChatPaneControlProps.startNewChatButtonText,
    onClick: handleStartNewChatClick,
    id: elementId + "-startnewconversationbutton",
    "aria-label": ((_props$controlProps23 = props.controlProps) === null || _props$controlProps23 === void 0 ? void 0 : _props$controlProps23.startNewChatButtonAriaLabel) || defaultReconnectChatPaneControlProps.startNewChatButtonAriaLabel
  }))))));
}

export default ReconnectChatPane;