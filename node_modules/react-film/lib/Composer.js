"use strict";

var _Object$defineProperty = require("@babel/runtime-corejs3/core-js-stable/object/define-property");
var _interopRequireWildcard = require("@babel/runtime-corejs3/helpers/interopRequireWildcard").default;
var _interopRequireDefault = require("@babel/runtime-corejs3/helpers/interopRequireDefault").default;
_Object$defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _objectSpread2 = _interopRequireDefault(require("@babel/runtime-corejs3/helpers/objectSpread2"));
var _slicedToArray2 = _interopRequireDefault(require("@babel/runtime-corejs3/helpers/slicedToArray"));
var _fromEntries = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/object/from-entries"));
var _map = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/instance/map"));
var _entries = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/object/entries"));
var _setTimeout2 = _interopRequireDefault(require("@babel/runtime-corejs3/core-js-stable/set-timeout"));
var _createInstance = _interopRequireDefault(require("@emotion/css/create-instance"));
var _propTypes = _interopRequireDefault(require("prop-types"));
var _react = _interopRequireWildcard(require("react"));
var _AutoCenter = _interopRequireDefault(require("./AutoCenter"));
var _computeScrollLeft = _interopRequireDefault(require("./computeScrollLeft"));
var _createBasicStyleSet = _interopRequireDefault(require("./createBasicStyleSet"));
var _createCSSKey = _interopRequireDefault(require("./util/createCSSKey"));
var _FunctionContext = _interopRequireDefault(require("./FunctionContext"));
var _getView = _interopRequireDefault(require("./getView"));
var _InternalContext = _interopRequireDefault(require("./InternalContext"));
var _LegacyContext = _interopRequireDefault(require("./LegacyContext"));
var _patchStyleOptions = _interopRequireDefault(require("./patchStyleOptions"));
var _PropsContext = _interopRequireDefault(require("./PropsContext"));
var _useAnimateScrollLeft = _interopRequireDefault(require("./hooks/internal/useAnimateScrollLeft"));
var _useCallbackRefWithSubscribe = _interopRequireDefault(require("./hooks/internal/useCallbackRefWithSubscribe"));
var _useObserveScrollLeft = _interopRequireDefault(require("./hooks/internal/useObserveScrollLeft"));
var _ViewContext = _interopRequireDefault(require("./ViewContext"));
// We pool the emotion, so we don't create a new set of <style> for every component and reuse as much as we could.
var emotionPool = {};
var Composer = function Composer(_ref) {
  var children = _ref.children,
    dir = _ref.dir,
    height = _ref.height,
    nonce = _ref.nonce,
    numItems = _ref.numItems,
    styleOptions = _ref.styleOptions,
    styleSet = _ref.styleSet;
  dir = dir === 'ltr' || dir === 'rtl' ? dir : undefined;
  var patchedStyleOptions = (0, _react.useMemo)(function () {
    return (0, _patchStyleOptions.default)(styleOptions);
  }, [styleOptions]);
  var patchedStyleSet = (0, _react.useMemo)(function () {
    return styleSet || (0, _createBasicStyleSet.default)(patchedStyleOptions);
  }, [patchedStyleOptions, styleSet]);
  var styleSetClassNames = (0, _react.useMemo)(function () {
    var _context;
    var emotion = emotionPool[nonce] || (emotionPool[nonce] = (0, _createInstance.default)({
      key: "react-film--css-".concat((0, _createCSSKey.default)()),
      nonce: nonce
    }));
    return (0, _fromEntries.default)((0, _map.default)(_context = (0, _entries.default)(patchedStyleSet)).call(_context, function (_ref2) {
      var _ref3 = (0, _slicedToArray2.default)(_ref2, 2),
        name = _ref3[0],
        style = _ref3[1];
      return [name, emotion.css(style) + ''];
    }));
  }, [nonce, patchedStyleSet]);
  var _useState = (0, _react.useState)(),
    _useState2 = (0, _slicedToArray2.default)(_useState, 2),
    _ = _useState2[0],
    forceRender = _useState2[1];
  var itemContainerCallbackRefWithSubscribe = (0, _useCallbackRefWithSubscribe.default)();
  var scrollableCallbackRefWithSubscribe = (0, _useCallbackRefWithSubscribe.default)();
  var scrollLeftRef = (0, _react.useRef)(null);
  var scrollTimeoutRef = (0, _react.useRef)();
  (0, _react.useEffect)(function () {
    return function () {
      return clearTimeout(scrollTimeoutRef.current);
    };
  }, [scrollTimeoutRef]);
  var scrollTo = (0, _react.useCallback)(function (scrollFn) {
    var view = (0, _getView.default)(dir, scrollableCallbackRefWithSubscribe.current, itemContainerCallbackRefWithSubscribe.current, scrollLeftRef.current);
    if (view) {
      var index = view.index,
        indexFraction = view.indexFraction;
      var targetIndex = scrollFn({
        index: index,
        indexFraction: indexFraction
      });
      if (typeof targetIndex === 'number') {
        scrollLeftRef.current = (0, _computeScrollLeft.default)(dir, scrollableCallbackRefWithSubscribe.current, itemContainerCallbackRefWithSubscribe.current, targetIndex);
        forceRender({});
      }
    }
  }, [dir, forceRender, itemContainerCallbackRefWithSubscribe, scrollableCallbackRefWithSubscribe, scrollLeftRef]);
  var scrollOneLeft = (0, _react.useCallback)(function () {
    scrollTo(function (_ref4) {
      var indexFraction = _ref4.indexFraction;
      return dir === 'rtl' ? Math.floor(indexFraction) + 1 : Math.ceil(indexFraction) - 1;
    });
  }, [dir, scrollTo]);
  var scrollOneRight = (0, _react.useCallback)(function () {
    scrollTo(function (_ref5) {
      var indexFraction = _ref5.indexFraction;
      return dir === 'rtl' ? Math.ceil(indexFraction) - 1 : Math.floor(indexFraction) + 1;
    });
  }, [dir, scrollTo]);
  var functionContext = (0, _react.useMemo)(function () {
    return {
      scrollTo: scrollTo,
      scrollOneLeft: scrollOneLeft,
      scrollOneRight: scrollOneRight
    };
  }, [scrollTo, scrollOneLeft, scrollOneRight]);
  var internalContext = (0, _react.useMemo)(function () {
    return {
      itemContainerCallbackRefWithSubscribe: itemContainerCallbackRefWithSubscribe,
      scrollableCallbackRefWithSubscribe: scrollableCallbackRefWithSubscribe
    };
  }, [itemContainerCallbackRefWithSubscribe, scrollableCallbackRefWithSubscribe]);
  var propsContext = (0, _react.useMemo)(function () {
    return {
      dir: dir,
      height: height,
      nonce: nonce,
      numItems: numItems,
      styleOptions: patchedStyleOptions,
      styleSetClassNames: styleSetClassNames
    };
  }, [dir, height, nonce, numItems, patchedStyleOptions, styleSetClassNames]);
  var _useState3 = (0, _react.useState)({
      index: 0,
      indexFraction: 0,
      scrollBarPercentage: '0%',
      scrollBarWidth: '0%',
      scrolling: false
    }),
    _useState4 = (0, _slicedToArray2.default)(_useState3, 2),
    viewContext = _useState4[0],
    setViewContext = _useState4[1];

  // This will setViewContext and reset the "scrolling" flag after a period of time.
  var setViewContext2 = (0, _react.useCallback)(function (nextViewContext) {
    setViewContext(nextViewContext);
    clearTimeout(scrollTimeoutRef.current);
    if (nextViewContext.scrolling) {
      scrollTimeoutRef.current = (0, _setTimeout2.default)(function () {
        return setViewContext((0, _objectSpread2.default)((0, _objectSpread2.default)({}, nextViewContext), {}, {
          scrolling: false
        }));
      },
      // eslint-disable-next-line no-magic-numbers
      500);
    }
  }, [scrollTimeoutRef, setViewContext]);
  var handleScroll = (0, _react.useCallback)(function (_ref6) {
    var scrollBarPercentage = _ref6.fraction,
      initial = _ref6.initial,
      scrollBarWidth = _ref6.width;
    var view = (0, _getView.default)(dir, scrollableCallbackRefWithSubscribe.current, itemContainerCallbackRefWithSubscribe.current, scrollLeftRef.current);
    if (view) {
      var index = view.index,
        indexFraction = view.indexFraction;
      setViewContext2({
        index: index,
        indexFraction: indexFraction,
        scrolling: !initial,
        scrollBarPercentage: scrollBarPercentage,
        scrollBarWidth: scrollBarWidth
      });
    }
  }, [dir, itemContainerCallbackRefWithSubscribe, scrollableCallbackRefWithSubscribe, scrollLeftRef, setViewContext2]);
  var handleScrollToEnd = (0, _react.useCallback)(function () {
    scrollLeftRef.current = null;
    forceRender({});
  }, [forceRender, scrollLeftRef]);
  var legacyContext = (0, _react.useMemo)(function () {
    return (0, _objectSpread2.default)((0, _objectSpread2.default)((0, _objectSpread2.default)((0, _objectSpread2.default)({}, functionContext), internalContext), propsContext), viewContext);
  }, [functionContext, internalContext, propsContext, viewContext]);
  (0, _useAnimateScrollLeft.default)(typeof scrollLeftRef.current === 'number' && scrollableCallbackRefWithSubscribe.current, scrollLeftRef.current, handleScrollToEnd);
  (0, _react.useEffect)(function () {
    return scrollableCallbackRefWithSubscribe.subscribe(function (current) {
      if (current) {
        current.addEventListener('pointerdown', handleScrollToEnd, {
          passive: true
        });
        return function () {
          return current.removeEventListener('pointerdown', handleScrollToEnd);
        };
      }
    });
  }, [handleScrollToEnd, scrollableCallbackRefWithSubscribe]);
  (0, _useObserveScrollLeft.default)(scrollableCallbackRefWithSubscribe, handleScroll);
  return /*#__PURE__*/_react.default.createElement(_PropsContext.default.Provider, {
    value: propsContext
  }, /*#__PURE__*/_react.default.createElement(_InternalContext.default.Provider, {
    value: internalContext
  }, /*#__PURE__*/_react.default.createElement(_FunctionContext.default.Provider, {
    value: functionContext
  }, /*#__PURE__*/_react.default.createElement(_ViewContext.default.Provider, {
    value: viewContext
  }, /*#__PURE__*/_react.default.createElement(_LegacyContext.default.Provider, {
    value: legacyContext
  }, children, patchedStyleOptions.autoCenter && /*#__PURE__*/_react.default.createElement(_AutoCenter.default, null))))));
};
Composer.defaultProps = {
  children: undefined,
  dir: undefined,
  height: undefined,
  nonce: undefined,
  styleOptions: undefined,
  styleSet: undefined
};
Composer.propTypes = {
  children: _propTypes.default.oneOfType([_propTypes.default.arrayOf(_propTypes.default.element), _propTypes.default.element]),
  dir: _propTypes.default.oneOf(['ltr', 'rtl']),
  height: _propTypes.default.number,
  nonce: _propTypes.default.string,
  numItems: _propTypes.default.number.isRequired,
  styleOptions: _propTypes.default.any,
  styleSet: _propTypes.default.any
};
var _default = Composer;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJlbW90aW9uUG9vbCIsIkNvbXBvc2VyIiwiY2hpbGRyZW4iLCJkaXIiLCJoZWlnaHQiLCJub25jZSIsIm51bUl0ZW1zIiwic3R5bGVPcHRpb25zIiwic3R5bGVTZXQiLCJ1bmRlZmluZWQiLCJwYXRjaGVkU3R5bGVPcHRpb25zIiwidXNlTWVtbyIsInBhdGNoU3R5bGVPcHRpb25zIiwicGF0Y2hlZFN0eWxlU2V0IiwiY3JlYXRlQmFzaWNTdHlsZVNldCIsInN0eWxlU2V0Q2xhc3NOYW1lcyIsImVtb3Rpb24iLCJjcmVhdGVFbW90aW9uIiwia2V5IiwiY3JlYXRlQ1NTS2V5IiwibmFtZSIsInN0eWxlIiwiY3NzIiwidXNlU3RhdGUiLCJfIiwiZm9yY2VSZW5kZXIiLCJpdGVtQ29udGFpbmVyQ2FsbGJhY2tSZWZXaXRoU3Vic2NyaWJlIiwidXNlQ2FsbGJhY2tSZWZXaXRoU3Vic2NyaWJlIiwic2Nyb2xsYWJsZUNhbGxiYWNrUmVmV2l0aFN1YnNjcmliZSIsInNjcm9sbExlZnRSZWYiLCJ1c2VSZWYiLCJzY3JvbGxUaW1lb3V0UmVmIiwidXNlRWZmZWN0IiwiY2xlYXJUaW1lb3V0IiwiY3VycmVudCIsInNjcm9sbFRvIiwidXNlQ2FsbGJhY2siLCJzY3JvbGxGbiIsInZpZXciLCJnZXRWaWV3IiwiaW5kZXgiLCJpbmRleEZyYWN0aW9uIiwidGFyZ2V0SW5kZXgiLCJjb21wdXRlU2Nyb2xsTGVmdCIsInNjcm9sbE9uZUxlZnQiLCJNYXRoIiwiZmxvb3IiLCJjZWlsIiwic2Nyb2xsT25lUmlnaHQiLCJmdW5jdGlvbkNvbnRleHQiLCJpbnRlcm5hbENvbnRleHQiLCJwcm9wc0NvbnRleHQiLCJzY3JvbGxCYXJQZXJjZW50YWdlIiwic2Nyb2xsQmFyV2lkdGgiLCJzY3JvbGxpbmciLCJ2aWV3Q29udGV4dCIsInNldFZpZXdDb250ZXh0Iiwic2V0Vmlld0NvbnRleHQyIiwibmV4dFZpZXdDb250ZXh0IiwiaGFuZGxlU2Nyb2xsIiwiZnJhY3Rpb24iLCJpbml0aWFsIiwid2lkdGgiLCJoYW5kbGVTY3JvbGxUb0VuZCIsImxlZ2FjeUNvbnRleHQiLCJ1c2VBbmltYXRlU2Nyb2xsTGVmdCIsInN1YnNjcmliZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJwYXNzaXZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsInVzZU9ic2VydmVTY3JvbGxMZWZ0IiwiYXV0b0NlbnRlciIsImRlZmF1bHRQcm9wcyIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsIm9uZU9mVHlwZSIsImFycmF5T2YiLCJlbGVtZW50Iiwib25lT2YiLCJudW1iZXIiLCJzdHJpbmciLCJpc1JlcXVpcmVkIiwiYW55Il0sInNvdXJjZXMiOlsiLi4vc3JjL0NvbXBvc2VyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcmVhdGVFbW90aW9uIGZyb20gJ0BlbW90aW9uL2Nzcy9jcmVhdGUtaW5zdGFuY2UnO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tICdwcm9wLXR5cGVzJztcbmltcG9ydCBSZWFjdCwgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgQXV0b0NlbnRlciBmcm9tICcuL0F1dG9DZW50ZXInO1xuaW1wb3J0IGNvbXB1dGVTY3JvbGxMZWZ0IGZyb20gJy4vY29tcHV0ZVNjcm9sbExlZnQnO1xuaW1wb3J0IGNyZWF0ZUJhc2ljU3R5bGVTZXQgZnJvbSAnLi9jcmVhdGVCYXNpY1N0eWxlU2V0JztcbmltcG9ydCBjcmVhdGVDU1NLZXkgZnJvbSAnLi91dGlsL2NyZWF0ZUNTU0tleSc7XG5pbXBvcnQgRnVuY3Rpb25Db250ZXh0IGZyb20gJy4vRnVuY3Rpb25Db250ZXh0JztcbmltcG9ydCBnZXRWaWV3IGZyb20gJy4vZ2V0Vmlldyc7XG5pbXBvcnQgSW50ZXJuYWxDb250ZXh0IGZyb20gJy4vSW50ZXJuYWxDb250ZXh0JztcbmltcG9ydCBMZWdhY3lDb250ZXh0IGZyb20gJy4vTGVnYWN5Q29udGV4dCc7XG5pbXBvcnQgcGF0Y2hTdHlsZU9wdGlvbnMgZnJvbSAnLi9wYXRjaFN0eWxlT3B0aW9ucyc7XG5pbXBvcnQgUHJvcHNDb250ZXh0IGZyb20gJy4vUHJvcHNDb250ZXh0JztcbmltcG9ydCB1c2VBbmltYXRlU2Nyb2xsTGVmdCBmcm9tICcuL2hvb2tzL2ludGVybmFsL3VzZUFuaW1hdGVTY3JvbGxMZWZ0JztcbmltcG9ydCB1c2VDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUgZnJvbSAnLi9ob29rcy9pbnRlcm5hbC91c2VDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUnO1xuaW1wb3J0IHVzZU9ic2VydmVTY3JvbGxMZWZ0IGZyb20gJy4vaG9va3MvaW50ZXJuYWwvdXNlT2JzZXJ2ZVNjcm9sbExlZnQnO1xuaW1wb3J0IFZpZXdDb250ZXh0IGZyb20gJy4vVmlld0NvbnRleHQnO1xuXG4vLyBXZSBwb29sIHRoZSBlbW90aW9uLCBzbyB3ZSBkb24ndCBjcmVhdGUgYSBuZXcgc2V0IG9mIDxzdHlsZT4gZm9yIGV2ZXJ5IGNvbXBvbmVudCBhbmQgcmV1c2UgYXMgbXVjaCBhcyB3ZSBjb3VsZC5cbmNvbnN0IGVtb3Rpb25Qb29sID0ge307XG5cbmNvbnN0IENvbXBvc2VyID0gKHsgY2hpbGRyZW4sIGRpciwgaGVpZ2h0LCBub25jZSwgbnVtSXRlbXMsIHN0eWxlT3B0aW9ucywgc3R5bGVTZXQgfSkgPT4ge1xuICBkaXIgPSBkaXIgPT09ICdsdHInIHx8IGRpciA9PT0gJ3J0bCcgPyBkaXIgOiB1bmRlZmluZWQ7XG5cbiAgY29uc3QgcGF0Y2hlZFN0eWxlT3B0aW9ucyA9IHVzZU1lbW8oKCkgPT4gcGF0Y2hTdHlsZU9wdGlvbnMoc3R5bGVPcHRpb25zKSwgW3N0eWxlT3B0aW9uc10pO1xuICBjb25zdCBwYXRjaGVkU3R5bGVTZXQgPSB1c2VNZW1vKFxuICAgICgpID0+IHN0eWxlU2V0IHx8IGNyZWF0ZUJhc2ljU3R5bGVTZXQocGF0Y2hlZFN0eWxlT3B0aW9ucyksXG4gICAgW3BhdGNoZWRTdHlsZU9wdGlvbnMsIHN0eWxlU2V0XVxuICApO1xuXG4gIGNvbnN0IHN0eWxlU2V0Q2xhc3NOYW1lcyA9IHVzZU1lbW8oKCkgPT4ge1xuICAgIGNvbnN0IGVtb3Rpb24gPVxuICAgICAgZW1vdGlvblBvb2xbbm9uY2VdIHx8IChlbW90aW9uUG9vbFtub25jZV0gPSBjcmVhdGVFbW90aW9uKHsga2V5OiBgcmVhY3QtZmlsbS0tY3NzLSR7Y3JlYXRlQ1NTS2V5KCl9YCwgbm9uY2UgfSkpO1xuXG4gICAgcmV0dXJuIE9iamVjdC5mcm9tRW50cmllcyhPYmplY3QuZW50cmllcyhwYXRjaGVkU3R5bGVTZXQpLm1hcCgoW25hbWUsIHN0eWxlXSkgPT4gW25hbWUsIGVtb3Rpb24uY3NzKHN0eWxlKSArICcnXSkpO1xuICB9LCBbbm9uY2UsIHBhdGNoZWRTdHlsZVNldF0pO1xuXG4gIGNvbnN0IFtfLCBmb3JjZVJlbmRlcl0gPSB1c2VTdGF0ZSgpO1xuICBjb25zdCBpdGVtQ29udGFpbmVyQ2FsbGJhY2tSZWZXaXRoU3Vic2NyaWJlID0gdXNlQ2FsbGJhY2tSZWZXaXRoU3Vic2NyaWJlKCk7XG4gIGNvbnN0IHNjcm9sbGFibGVDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUgPSB1c2VDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUoKTtcbiAgY29uc3Qgc2Nyb2xsTGVmdFJlZiA9IHVzZVJlZihudWxsKTtcbiAgY29uc3Qgc2Nyb2xsVGltZW91dFJlZiA9IHVzZVJlZigpO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiAoKSA9PiBjbGVhclRpbWVvdXQoc2Nyb2xsVGltZW91dFJlZi5jdXJyZW50KSwgW3Njcm9sbFRpbWVvdXRSZWZdKTtcblxuICBjb25zdCBzY3JvbGxUbyA9IHVzZUNhbGxiYWNrKFxuICAgIHNjcm9sbEZuID0+IHtcbiAgICAgIGNvbnN0IHZpZXcgPSBnZXRWaWV3KFxuICAgICAgICBkaXIsXG4gICAgICAgIHNjcm9sbGFibGVDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUuY3VycmVudCxcbiAgICAgICAgaXRlbUNvbnRhaW5lckNhbGxiYWNrUmVmV2l0aFN1YnNjcmliZS5jdXJyZW50LFxuICAgICAgICBzY3JvbGxMZWZ0UmVmLmN1cnJlbnRcbiAgICAgICk7XG5cbiAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgIGNvbnN0IHsgaW5kZXgsIGluZGV4RnJhY3Rpb24gfSA9IHZpZXc7XG4gICAgICAgIGNvbnN0IHRhcmdldEluZGV4ID0gc2Nyb2xsRm4oeyBpbmRleCwgaW5kZXhGcmFjdGlvbiB9KTtcblxuICAgICAgICBpZiAodHlwZW9mIHRhcmdldEluZGV4ID09PSAnbnVtYmVyJykge1xuICAgICAgICAgIHNjcm9sbExlZnRSZWYuY3VycmVudCA9IGNvbXB1dGVTY3JvbGxMZWZ0KFxuICAgICAgICAgICAgZGlyLFxuICAgICAgICAgICAgc2Nyb2xsYWJsZUNhbGxiYWNrUmVmV2l0aFN1YnNjcmliZS5jdXJyZW50LFxuICAgICAgICAgICAgaXRlbUNvbnRhaW5lckNhbGxiYWNrUmVmV2l0aFN1YnNjcmliZS5jdXJyZW50LFxuICAgICAgICAgICAgdGFyZ2V0SW5kZXhcbiAgICAgICAgICApO1xuICAgICAgICAgIGZvcmNlUmVuZGVyKHt9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgW2RpciwgZm9yY2VSZW5kZXIsIGl0ZW1Db250YWluZXJDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUsIHNjcm9sbGFibGVDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUsIHNjcm9sbExlZnRSZWZdXG4gICk7XG5cbiAgY29uc3Qgc2Nyb2xsT25lTGVmdCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBzY3JvbGxUbygoeyBpbmRleEZyYWN0aW9uIH0pID0+IChkaXIgPT09ICdydGwnID8gTWF0aC5mbG9vcihpbmRleEZyYWN0aW9uKSArIDEgOiBNYXRoLmNlaWwoaW5kZXhGcmFjdGlvbikgLSAxKSk7XG4gIH0sIFtkaXIsIHNjcm9sbFRvXSk7XG5cbiAgY29uc3Qgc2Nyb2xsT25lUmlnaHQgPSB1c2VDYWxsYmFjaygoKSA9PiB7XG4gICAgc2Nyb2xsVG8oKHsgaW5kZXhGcmFjdGlvbiB9KSA9PiAoZGlyID09PSAncnRsJyA/IE1hdGguY2VpbChpbmRleEZyYWN0aW9uKSAtIDEgOiBNYXRoLmZsb29yKGluZGV4RnJhY3Rpb24pICsgMSkpO1xuICB9LCBbZGlyLCBzY3JvbGxUb10pO1xuXG4gIGNvbnN0IGZ1bmN0aW9uQ29udGV4dCA9IHVzZU1lbW8oXG4gICAgKCkgPT4gKHtcbiAgICAgIHNjcm9sbFRvLFxuICAgICAgc2Nyb2xsT25lTGVmdCxcbiAgICAgIHNjcm9sbE9uZVJpZ2h0XG4gICAgfSksXG4gICAgW3Njcm9sbFRvLCBzY3JvbGxPbmVMZWZ0LCBzY3JvbGxPbmVSaWdodF1cbiAgKTtcblxuICBjb25zdCBpbnRlcm5hbENvbnRleHQgPSB1c2VNZW1vKFxuICAgICgpID0+ICh7XG4gICAgICBpdGVtQ29udGFpbmVyQ2FsbGJhY2tSZWZXaXRoU3Vic2NyaWJlLFxuICAgICAgc2Nyb2xsYWJsZUNhbGxiYWNrUmVmV2l0aFN1YnNjcmliZVxuICAgIH0pLFxuICAgIFtpdGVtQ29udGFpbmVyQ2FsbGJhY2tSZWZXaXRoU3Vic2NyaWJlLCBzY3JvbGxhYmxlQ2FsbGJhY2tSZWZXaXRoU3Vic2NyaWJlXVxuICApO1xuXG4gIGNvbnN0IHByb3BzQ29udGV4dCA9IHVzZU1lbW8oXG4gICAgKCkgPT4gKHsgZGlyLCBoZWlnaHQsIG5vbmNlLCBudW1JdGVtcywgc3R5bGVPcHRpb25zOiBwYXRjaGVkU3R5bGVPcHRpb25zLCBzdHlsZVNldENsYXNzTmFtZXMgfSksXG4gICAgW2RpciwgaGVpZ2h0LCBub25jZSwgbnVtSXRlbXMsIHBhdGNoZWRTdHlsZU9wdGlvbnMsIHN0eWxlU2V0Q2xhc3NOYW1lc11cbiAgKTtcblxuICBjb25zdCBbdmlld0NvbnRleHQsIHNldFZpZXdDb250ZXh0XSA9IHVzZVN0YXRlKHtcbiAgICBpbmRleDogMCxcbiAgICBpbmRleEZyYWN0aW9uOiAwLFxuICAgIHNjcm9sbEJhclBlcmNlbnRhZ2U6ICcwJScsXG4gICAgc2Nyb2xsQmFyV2lkdGg6ICcwJScsXG4gICAgc2Nyb2xsaW5nOiBmYWxzZVxuICB9KTtcblxuICAvLyBUaGlzIHdpbGwgc2V0Vmlld0NvbnRleHQgYW5kIHJlc2V0IHRoZSBcInNjcm9sbGluZ1wiIGZsYWcgYWZ0ZXIgYSBwZXJpb2Qgb2YgdGltZS5cbiAgY29uc3Qgc2V0Vmlld0NvbnRleHQyID0gdXNlQ2FsbGJhY2soXG4gICAgbmV4dFZpZXdDb250ZXh0ID0+IHtcbiAgICAgIHNldFZpZXdDb250ZXh0KG5leHRWaWV3Q29udGV4dCk7XG5cbiAgICAgIGNsZWFyVGltZW91dChzY3JvbGxUaW1lb3V0UmVmLmN1cnJlbnQpO1xuXG4gICAgICBpZiAobmV4dFZpZXdDb250ZXh0LnNjcm9sbGluZykge1xuICAgICAgICBzY3JvbGxUaW1lb3V0UmVmLmN1cnJlbnQgPSBzZXRUaW1lb3V0KFxuICAgICAgICAgICgpID0+XG4gICAgICAgICAgICBzZXRWaWV3Q29udGV4dCh7XG4gICAgICAgICAgICAgIC4uLm5leHRWaWV3Q29udGV4dCxcbiAgICAgICAgICAgICAgc2Nyb2xsaW5nOiBmYWxzZVxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLW1hZ2ljLW51bWJlcnNcbiAgICAgICAgICA1MDBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtzY3JvbGxUaW1lb3V0UmVmLCBzZXRWaWV3Q29udGV4dF1cbiAgKTtcblxuICBjb25zdCBoYW5kbGVTY3JvbGwgPSB1c2VDYWxsYmFjayhcbiAgICAoeyBmcmFjdGlvbjogc2Nyb2xsQmFyUGVyY2VudGFnZSwgaW5pdGlhbCwgd2lkdGg6IHNjcm9sbEJhcldpZHRoIH0pID0+IHtcbiAgICAgIGNvbnN0IHZpZXcgPSBnZXRWaWV3KFxuICAgICAgICBkaXIsXG4gICAgICAgIHNjcm9sbGFibGVDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUuY3VycmVudCxcbiAgICAgICAgaXRlbUNvbnRhaW5lckNhbGxiYWNrUmVmV2l0aFN1YnNjcmliZS5jdXJyZW50LFxuICAgICAgICBzY3JvbGxMZWZ0UmVmLmN1cnJlbnRcbiAgICAgICk7XG5cbiAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgIGNvbnN0IHsgaW5kZXgsIGluZGV4RnJhY3Rpb24gfSA9IHZpZXc7XG5cbiAgICAgICAgc2V0Vmlld0NvbnRleHQyKHtcbiAgICAgICAgICBpbmRleCxcbiAgICAgICAgICBpbmRleEZyYWN0aW9uLFxuICAgICAgICAgIHNjcm9sbGluZzogIWluaXRpYWwsXG4gICAgICAgICAgc2Nyb2xsQmFyUGVyY2VudGFnZSxcbiAgICAgICAgICBzY3JvbGxCYXJXaWR0aFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtkaXIsIGl0ZW1Db250YWluZXJDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUsIHNjcm9sbGFibGVDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUsIHNjcm9sbExlZnRSZWYsIHNldFZpZXdDb250ZXh0Ml1cbiAgKTtcblxuICBjb25zdCBoYW5kbGVTY3JvbGxUb0VuZCA9IHVzZUNhbGxiYWNrKCgpID0+IHtcbiAgICBzY3JvbGxMZWZ0UmVmLmN1cnJlbnQgPSBudWxsO1xuICAgIGZvcmNlUmVuZGVyKHt9KTtcbiAgfSwgW2ZvcmNlUmVuZGVyLCBzY3JvbGxMZWZ0UmVmXSk7XG5cbiAgY29uc3QgbGVnYWN5Q29udGV4dCA9IHVzZU1lbW8oXG4gICAgKCkgPT4gKHtcbiAgICAgIC4uLmZ1bmN0aW9uQ29udGV4dCxcbiAgICAgIC4uLmludGVybmFsQ29udGV4dCxcbiAgICAgIC4uLnByb3BzQ29udGV4dCxcbiAgICAgIC4uLnZpZXdDb250ZXh0XG4gICAgfSksXG4gICAgW2Z1bmN0aW9uQ29udGV4dCwgaW50ZXJuYWxDb250ZXh0LCBwcm9wc0NvbnRleHQsIHZpZXdDb250ZXh0XVxuICApO1xuXG4gIHVzZUFuaW1hdGVTY3JvbGxMZWZ0KFxuICAgIHR5cGVvZiBzY3JvbGxMZWZ0UmVmLmN1cnJlbnQgPT09ICdudW1iZXInICYmIHNjcm9sbGFibGVDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUuY3VycmVudCxcbiAgICBzY3JvbGxMZWZ0UmVmLmN1cnJlbnQsXG4gICAgaGFuZGxlU2Nyb2xsVG9FbmRcbiAgKTtcblxuICB1c2VFZmZlY3QoXG4gICAgKCkgPT5cbiAgICAgIHNjcm9sbGFibGVDYWxsYmFja1JlZldpdGhTdWJzY3JpYmUuc3Vic2NyaWJlKGN1cnJlbnQgPT4ge1xuICAgICAgICBpZiAoY3VycmVudCkge1xuICAgICAgICAgIGN1cnJlbnQuYWRkRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCBoYW5kbGVTY3JvbGxUb0VuZCwgeyBwYXNzaXZlOiB0cnVlIH0pO1xuXG4gICAgICAgICAgcmV0dXJuICgpID0+IGN1cnJlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigncG9pbnRlcmRvd24nLCBoYW5kbGVTY3JvbGxUb0VuZCk7XG4gICAgICAgIH1cbiAgICAgIH0pLFxuICAgIFtoYW5kbGVTY3JvbGxUb0VuZCwgc2Nyb2xsYWJsZUNhbGxiYWNrUmVmV2l0aFN1YnNjcmliZV1cbiAgKTtcblxuICB1c2VPYnNlcnZlU2Nyb2xsTGVmdChzY3JvbGxhYmxlQ2FsbGJhY2tSZWZXaXRoU3Vic2NyaWJlLCBoYW5kbGVTY3JvbGwpO1xuXG4gIHJldHVybiAoXG4gICAgPFByb3BzQ29udGV4dC5Qcm92aWRlciB2YWx1ZT17cHJvcHNDb250ZXh0fT5cbiAgICAgIDxJbnRlcm5hbENvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2ludGVybmFsQ29udGV4dH0+XG4gICAgICAgIDxGdW5jdGlvbkNvbnRleHQuUHJvdmlkZXIgdmFsdWU9e2Z1bmN0aW9uQ29udGV4dH0+XG4gICAgICAgICAgPFZpZXdDb250ZXh0LlByb3ZpZGVyIHZhbHVlPXt2aWV3Q29udGV4dH0+XG4gICAgICAgICAgICA8TGVnYWN5Q29udGV4dC5Qcm92aWRlciB2YWx1ZT17bGVnYWN5Q29udGV4dH0+XG4gICAgICAgICAgICAgIHtjaGlsZHJlbn1cbiAgICAgICAgICAgICAge3BhdGNoZWRTdHlsZU9wdGlvbnMuYXV0b0NlbnRlciAmJiA8QXV0b0NlbnRlciAvPn1cbiAgICAgICAgICAgIDwvTGVnYWN5Q29udGV4dC5Qcm92aWRlcj5cbiAgICAgICAgICA8L1ZpZXdDb250ZXh0LlByb3ZpZGVyPlxuICAgICAgICA8L0Z1bmN0aW9uQ29udGV4dC5Qcm92aWRlcj5cbiAgICAgIDwvSW50ZXJuYWxDb250ZXh0LlByb3ZpZGVyPlxuICAgIDwvUHJvcHNDb250ZXh0LlByb3ZpZGVyPlxuICApO1xufTtcblxuQ29tcG9zZXIuZGVmYXVsdFByb3BzID0ge1xuICBjaGlsZHJlbjogdW5kZWZpbmVkLFxuICBkaXI6IHVuZGVmaW5lZCxcbiAgaGVpZ2h0OiB1bmRlZmluZWQsXG4gIG5vbmNlOiB1bmRlZmluZWQsXG4gIHN0eWxlT3B0aW9uczogdW5kZWZpbmVkLFxuICBzdHlsZVNldDogdW5kZWZpbmVkXG59O1xuXG5Db21wb3Nlci5wcm9wVHlwZXMgPSB7XG4gIGNoaWxkcmVuOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMuYXJyYXlPZihQcm9wVHlwZXMuZWxlbWVudCksIFByb3BUeXBlcy5lbGVtZW50XSksXG4gIGRpcjogUHJvcFR5cGVzLm9uZU9mKFsnbHRyJywgJ3J0bCddKSxcbiAgaGVpZ2h0OiBQcm9wVHlwZXMubnVtYmVyLFxuICBub25jZTogUHJvcFR5cGVzLnN0cmluZyxcbiAgbnVtSXRlbXM6IFByb3BUeXBlcy5udW1iZXIuaXNSZXF1aXJlZCxcbiAgc3R5bGVPcHRpb25zOiBQcm9wVHlwZXMuYW55LFxuICBzdHlsZVNldDogUHJvcFR5cGVzLmFueVxufTtcblxuZXhwb3J0IGRlZmF1bHQgQ29tcG9zZXI7XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBLElBQU1BLFdBQVcs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