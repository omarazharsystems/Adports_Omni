"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.connectCarouselFilmStrip = void 0;

var _botframeworkWebchatApi = require("botframework-webchat-api");

var _reactFilm = require("react-film");

var _classnames = _interopRequireDefault(require("classnames"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _Bubble = _interopRequireDefault(require("./Bubble"));

var _CarouselFilmStripAttachment = _interopRequireDefault(require("./CarouselFilmStripAttachment"));

var _connectToWebChat = _interopRequireDefault(require("../connectToWebChat"));

var _isZeroOrPositive = _interopRequireDefault(require("../Utils/isZeroOrPositive"));

var _ScreenReaderText = _interopRequireDefault(require("../ScreenReaderText"));

var _textFormatToContentType = _interopRequireDefault(require("../Utils/textFormatToContentType"));

var _useStyleSet3 = _interopRequireDefault(require("../hooks/useStyleSet"));

var _useStyleToEmotionObject = _interopRequireDefault(require("../hooks/internal/useStyleToEmotionObject"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var useAvatarForBot = _botframeworkWebchatApi.hooks.useAvatarForBot,
    useAvatarForUser = _botframeworkWebchatApi.hooks.useAvatarForUser,
    useDirection = _botframeworkWebchatApi.hooks.useDirection,
    useLocalizer = _botframeworkWebchatApi.hooks.useLocalizer,
    useStyleOptions = _botframeworkWebchatApi.hooks.useStyleOptions;
var ROOT_STYLE = {
  '&.webchat__carousel-filmstrip': {
    display: 'flex',
    flexDirection: 'column',
    MsOverflowStyle: 'none',
    overflowX: 'scroll',
    overflowY: 'hidden',
    position: 'relative',
    // This is to keep screen reader text in the destinated area.
    touchAction: 'manipulation',
    WebkitOverflowScrolling: 'touch',
    '&::-webkit-scrollbar': {
      display: 'none'
    },
    '& .webchat__carousel-filmstrip__alignment-pad': {
      flexShrink: 0
    },
    '& .webchat__carousel-filmstrip-attachment': {
      flex: 1
    },
    '& .webchat__carousel-filmstrip__attachments': {
      display: 'flex',
      listStyleType: 'none',
      margin: 0,
      padding: 0
    },
    '& .webchat__carousel-filmstrip__avatar': {
      flexShrink: 0
    },
    '& .webchat__carousel-filmstrip__avatar-gutter': {
      display: 'flex',
      flexDirection: 'column',
      flexShrink: 0
    },
    '& .webchat__carousel-filmstrip__complimentary': {
      display: 'flex'
    },
    '& .webchat__carousel-filmstrip__complimentary-content': {
      display: 'flex',
      flexGrow: 1,
      flexDirection: 'column'
    },
    '& .webchat__carousel-filmstrip__content': {
      display: 'flex',
      flexGrow: 1,
      flexDirection: 'column'
    },
    '& .webchat__carousel-filmstrip__filler': {
      flexGrow: 10000,
      flexShrink: 1
    },
    '& .webchat__carousel-filmstrip__main': {
      display: 'flex'
    },
    '& .webchat__carousel-filmstrip__message': {
      display: 'flex'
    },
    '& .webchat__carousel-filmstrip__nub-pad': {
      flexShrink: 0
    },
    '& .webchat__carousel-filmstrip__status': {
      display: 'flex'
    }
  }
};

var connectCarouselFilmStrip = function connectCarouselFilmStrip() {
  for (var _len = arguments.length, selectors = new Array(_len), _key = 0; _key < _len; _key++) {
    selectors[_key] = arguments[_key];
  }

  return _connectToWebChat.default.apply(void 0, [function (_ref, _ref2) {
    var language = _ref.language,
        _ref$styleSet$options = _ref.styleSet.options,
        botAvatarInitials = _ref$styleSet$options.botAvatarInitials,
        userAvatarInitials = _ref$styleSet$options.userAvatarInitials;
    var _ref2$activity = _ref2.activity;
    _ref2$activity = _ref2$activity === void 0 ? {} : _ref2$activity;
    var _ref2$activity$from = _ref2$activity.from;
    _ref2$activity$from = _ref2$activity$from === void 0 ? {} : _ref2$activity$from;
    var role = _ref2$activity$from.role;
    return {
      avatarInitials: role === 'user' ? userAvatarInitials : botAvatarInitials,
      language: language
    };
  }].concat(selectors));
};

exports.connectCarouselFilmStrip = connectCarouselFilmStrip;

var CarouselFilmStrip = function CarouselFilmStrip(_ref3) {
  var activity = _ref3.activity,
      className = _ref3.className,
      hideTimestamp = _ref3.hideTimestamp,
      renderActivityStatus = _ref3.renderActivityStatus,
      renderAttachment = _ref3.renderAttachment,
      renderAvatar = _ref3.renderAvatar,
      showCallout = _ref3.showCallout;

  var _useStyleOptions = useStyleOptions(),
      _useStyleOptions2 = _slicedToArray(_useStyleOptions, 1),
      _useStyleOptions2$ = _useStyleOptions2[0],
      bubbleNubOffset = _useStyleOptions2$.bubbleNubOffset,
      bubbleNubSize = _useStyleOptions2$.bubbleNubSize,
      bubbleFromUserNubOffset = _useStyleOptions2$.bubbleFromUserNubOffset,
      bubbleFromUserNubSize = _useStyleOptions2$.bubbleFromUserNubSize;

  var _useStyleSet = (0, _useStyleSet3.default)(),
      _useStyleSet2 = _slicedToArray(_useStyleSet, 1),
      carouselFilmStripStyleSet = _useStyleSet2[0].carouselFilmStrip;

  var _useAvatarForBot = useAvatarForBot(),
      _useAvatarForBot2 = _slicedToArray(_useAvatarForBot, 1),
      botInitials = _useAvatarForBot2[0].initials;

  var _useAvatarForUser = useAvatarForUser(),
      _useAvatarForUser2 = _slicedToArray(_useAvatarForUser, 1),
      userInitials = _useAvatarForUser2[0].initials;

  var _useDirection = useDirection(),
      _useDirection2 = _slicedToArray(_useDirection, 1),
      direction = _useDirection2[0];

  var localize = useLocalizer();
  var rootClassName = (0, _useStyleToEmotionObject.default)()(ROOT_STYLE) + '';
  var showActivityStatus = typeof renderActivityStatus === 'function';
  var itemContainerCallbackRef = (0, _reactFilm.useItemContainerCallbackRef)();
  var scrollableCallbackRef = (0, _reactFilm.useScrollableCallbackRef)();
  var _activity$attachments = activity.attachments,
      attachments = _activity$attachments === void 0 ? [] : _activity$attachments,
      _activity$channelData = activity.channelData;
  _activity$channelData = _activity$channelData === void 0 ? {} : _activity$channelData;
  var _activity$channelData2 = _activity$channelData.messageBack;
  _activity$channelData2 = _activity$channelData2 === void 0 ? {} : _activity$channelData2;
  var messageBackDisplayText = _activity$channelData2.displayText,
      _activity$from = activity.from;
  _activity$from = _activity$from === void 0 ? {} : _activity$from;
  var role = _activity$from.role,
      text = activity.text,
      textFormat = activity.textFormat;
  var activityDisplayText = messageBackDisplayText || text;
  var fromUser = role === 'user';
  var greetingAlt = (fromUser ? localize('ACTIVITY_YOU_SAID_ALT') : localize('ACTIVITY_BOT_SAID_ALT', botInitials || '')).replace(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]{2,}/g, ' ');
  var initials = fromUser ? userInitials : botInitials;
  var nubOffset = fromUser ? bubbleFromUserNubOffset : bubbleNubOffset;
  var nubSize = fromUser ? bubbleFromUserNubSize : bubbleNubSize;
  var otherInitials = fromUser ? botInitials : userInitials;
  var otherNubSize = fromUser ? bubbleNubSize : bubbleFromUserNubSize;
  var hasAvatar = initials || typeof initials === 'string';
  var hasOtherAvatar = otherInitials || typeof otherInitials === 'string';
  var hasNub = typeof nubSize === 'number';
  var hasOtherNub = typeof otherNubSize === 'number';
  var topAlignedCallout = (0, _isZeroOrPositive.default)(nubOffset);
  var extraTrailing = !hasOtherAvatar && hasOtherNub; // This is for bot message with user nub and no user avatar. And vice versa.

  var showAvatar = showCallout && hasAvatar && !!renderAvatar;
  var showNub = showCallout && hasNub && (topAlignedCallout || !attachments.length);
  var hideNub = hasNub && !showNub;
  return /*#__PURE__*/_react.default.createElement("div", {
    className: (0, _classnames.default)('webchat__carousel-filmstrip', {
      'webchat__carousel-filmstrip--extra-trailing': extraTrailing,
      'webchat__carousel-filmstrip--hide-avatar': hasAvatar && !showAvatar,
      'webchat__carousel-filmstrip--hide-nub': hideNub,
      'webchat__carousel-filmstrip--no-message': !activityDisplayText,
      'webchat__carousel-filmstrip--rtl': direction === 'rtl',
      'webchat__carousel-filmstrip--show-avatar': showAvatar,
      'webchat__carousel-filmstrip--show-nub': showNub,
      'webchat__carousel-filmstrip--top-callout': topAlignedCallout
    }, 'react-film__filmstrip', rootClassName, carouselFilmStripStyleSet + '', (className || '') + ''),
    ref: scrollableCallbackRef
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__carousel-filmstrip__main"
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__carousel-filmstrip__avatar-gutter"
  }, showAvatar && renderAvatar({
    activity: activity
  })), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__carousel-filmstrip__content"
  }, !!activityDisplayText && /*#__PURE__*/_react.default.createElement("div", {
    "aria-roledescription": "message",
    className: "webchat__carousel-filmstrip__message",
    role: "group"
  }, /*#__PURE__*/_react.default.createElement(_ScreenReaderText.default, {
    text: greetingAlt
  }), /*#__PURE__*/_react.default.createElement(_Bubble.default, {
    className: "webchat__carousel-filmstrip__bubble",
    fromUser: fromUser,
    nub: showNub || (hasAvatar || hasNub) && 'hidden'
  }, renderAttachment({
    activity: activity,
    attachment: {
      content: activityDisplayText,
      contentType: (0, _textFormatToContentType.default)(textFormat)
    }
  })), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__carousel-filmstrip__filler"
  })), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__carousel-filmstrip__complimentary"
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__carousel-filmstrip__nub-pad"
  }), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__carousel-filmstrip__complimentary-content c"
  }, /*#__PURE__*/_react.default.createElement("ul", {
    className: "webchat__carousel-filmstrip__attachments react-film__filmstrip__list",
    ref: itemContainerCallbackRef
  }, attachments.map(function (attachment, index) {
    return /*#__PURE__*/_react.default.createElement(_CarouselFilmStripAttachment.default, {
      activity: activity,
      attachment: attachment,
      fromUser: fromUser,
      hasAvatar: hasAvatar,
      hideNub: hideNub,
      index: index
      /* Attachments do not have an ID; it is always indexed by number */
      // eslint-disable-next-line react/no-array-index-key
      ,
      key: index,
      renderAttachment: renderAttachment,
      showAvatar: showAvatar,
      showNub: showNub
    });
  }))))), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__carousel-filmstrip__alignment-pad"
  })), showActivityStatus && /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__carousel-filmstrip__status"
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__carousel-filmstrip__avatar-gutter"
  }), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__carousel-filmstrip__nub-pad"
  }), renderActivityStatus({
    hideTimestamp: hideTimestamp
  })));
};

CarouselFilmStrip.defaultProps = {
  className: '',
  hideTimestamp: false,
  renderActivityStatus: false,
  renderAvatar: false,
  showCallout: false
};
CarouselFilmStrip.propTypes = {
  activity: _propTypes.default.shape({
    attachments: _propTypes.default.array,
    channelData: _propTypes.default.shape({
      messageBack: _propTypes.default.shape({
        displayText: _propTypes.default.string
      })
    }),
    from: _propTypes.default.shape({
      role: _propTypes.default.string.isRequired
    }).isRequired,
    text: _propTypes.default.string,
    textFormat: _propTypes.default.string,
    timestamp: _propTypes.default.string
  }).isRequired,
  className: _propTypes.default.string,
  hideTimestamp: _propTypes.default.bool,
  renderActivityStatus: _propTypes.default.oneOfType([_propTypes.default.oneOf([false]), _propTypes.default.func]),
  renderAttachment: _propTypes.default.func.isRequired,
  renderAvatar: _propTypes.default.oneOfType([_propTypes.default.oneOf([false]), _propTypes.default.func]),
  showCallout: _propTypes.default.bool
};
var _default = CarouselFilmStrip;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ1c2VBdmF0YXJGb3JCb3QiLCJob29rcyIsInVzZUF2YXRhckZvclVzZXIiLCJ1c2VEaXJlY3Rpb24iLCJ1c2VMb2NhbGl6ZXIiLCJ1c2VTdHlsZU9wdGlvbnMiLCJST09UX1NUWUxFIiwiZGlzcGxheSIsImZsZXhEaXJlY3Rpb24iLCJNc092ZXJmbG93U3R5bGUiLCJvdmVyZmxvd1giLCJvdmVyZmxvd1kiLCJwb3NpdGlvbiIsInRvdWNoQWN0aW9uIiwiV2Via2l0T3ZlcmZsb3dTY3JvbGxpbmciLCJmbGV4U2hyaW5rIiwiZmxleCIsImxpc3RTdHlsZVR5cGUiLCJtYXJnaW4iLCJwYWRkaW5nIiwiZmxleEdyb3ciLCJjb25uZWN0Q2Fyb3VzZWxGaWxtU3RyaXAiLCJzZWxlY3RvcnMiLCJjb25uZWN0VG9XZWJDaGF0IiwibGFuZ3VhZ2UiLCJzdHlsZVNldCIsIm9wdGlvbnMiLCJib3RBdmF0YXJJbml0aWFscyIsInVzZXJBdmF0YXJJbml0aWFscyIsImFjdGl2aXR5IiwiZnJvbSIsInJvbGUiLCJhdmF0YXJJbml0aWFscyIsIkNhcm91c2VsRmlsbVN0cmlwIiwiY2xhc3NOYW1lIiwiaGlkZVRpbWVzdGFtcCIsInJlbmRlckFjdGl2aXR5U3RhdHVzIiwicmVuZGVyQXR0YWNobWVudCIsInJlbmRlckF2YXRhciIsInNob3dDYWxsb3V0IiwiYnViYmxlTnViT2Zmc2V0IiwiYnViYmxlTnViU2l6ZSIsImJ1YmJsZUZyb21Vc2VyTnViT2Zmc2V0IiwiYnViYmxlRnJvbVVzZXJOdWJTaXplIiwidXNlU3R5bGVTZXQiLCJjYXJvdXNlbEZpbG1TdHJpcFN0eWxlU2V0IiwiY2Fyb3VzZWxGaWxtU3RyaXAiLCJib3RJbml0aWFscyIsImluaXRpYWxzIiwidXNlckluaXRpYWxzIiwiZGlyZWN0aW9uIiwibG9jYWxpemUiLCJyb290Q2xhc3NOYW1lIiwidXNlU3R5bGVUb0Vtb3Rpb25PYmplY3QiLCJzaG93QWN0aXZpdHlTdGF0dXMiLCJpdGVtQ29udGFpbmVyQ2FsbGJhY2tSZWYiLCJ1c2VJdGVtQ29udGFpbmVyQ2FsbGJhY2tSZWYiLCJzY3JvbGxhYmxlQ2FsbGJhY2tSZWYiLCJ1c2VTY3JvbGxhYmxlQ2FsbGJhY2tSZWYiLCJhdHRhY2htZW50cyIsImNoYW5uZWxEYXRhIiwibWVzc2FnZUJhY2siLCJtZXNzYWdlQmFja0Rpc3BsYXlUZXh0IiwiZGlzcGxheVRleHQiLCJ0ZXh0IiwidGV4dEZvcm1hdCIsImFjdGl2aXR5RGlzcGxheVRleHQiLCJmcm9tVXNlciIsImdyZWV0aW5nQWx0IiwicmVwbGFjZSIsIm51Yk9mZnNldCIsIm51YlNpemUiLCJvdGhlckluaXRpYWxzIiwib3RoZXJOdWJTaXplIiwiaGFzQXZhdGFyIiwiaGFzT3RoZXJBdmF0YXIiLCJoYXNOdWIiLCJoYXNPdGhlck51YiIsInRvcEFsaWduZWRDYWxsb3V0IiwiaXNaZXJvT3JQb3NpdGl2ZSIsImV4dHJhVHJhaWxpbmciLCJzaG93QXZhdGFyIiwic2hvd051YiIsImxlbmd0aCIsImhpZGVOdWIiLCJjbGFzc05hbWVzIiwiYXR0YWNobWVudCIsImNvbnRlbnQiLCJjb250ZW50VHlwZSIsInRleHRGb3JtYXRUb0NvbnRlbnRUeXBlIiwibWFwIiwiaW5kZXgiLCJkZWZhdWx0UHJvcHMiLCJwcm9wVHlwZXMiLCJQcm9wVHlwZXMiLCJzaGFwZSIsImFycmF5Iiwic3RyaW5nIiwiaXNSZXF1aXJlZCIsInRpbWVzdGFtcCIsImJvb2wiLCJvbmVPZlR5cGUiLCJvbmVPZiIsImZ1bmMiXSwic291cmNlUm9vdCI6ImNvbXBvbmVudDovLy8iLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9BY3Rpdml0eS9DYXJvdXNlbEZpbG1TdHJpcC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQgY29tcGxleGl0eTogW1wiZXJyb3JcIiwgMzBdICovXG5cbmltcG9ydCB7IGhvb2tzIH0gZnJvbSAnYm90ZnJhbWV3b3JrLXdlYmNoYXQtYXBpJztcbmltcG9ydCB7IHVzZUl0ZW1Db250YWluZXJDYWxsYmFja1JlZiwgdXNlU2Nyb2xsYWJsZUNhbGxiYWNrUmVmIH0gZnJvbSAncmVhY3QtZmlsbSc7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgQnViYmxlIGZyb20gJy4vQnViYmxlJztcbmltcG9ydCBDYXJvdXNlbEZpbG1TdHJpcEF0dGFjaG1lbnQgZnJvbSAnLi9DYXJvdXNlbEZpbG1TdHJpcEF0dGFjaG1lbnQnO1xuaW1wb3J0IGNvbm5lY3RUb1dlYkNoYXQgZnJvbSAnLi4vY29ubmVjdFRvV2ViQ2hhdCc7XG5pbXBvcnQgaXNaZXJvT3JQb3NpdGl2ZSBmcm9tICcuLi9VdGlscy9pc1plcm9PclBvc2l0aXZlJztcbmltcG9ydCBTY3JlZW5SZWFkZXJUZXh0IGZyb20gJy4uL1NjcmVlblJlYWRlclRleHQnO1xuaW1wb3J0IHRleHRGb3JtYXRUb0NvbnRlbnRUeXBlIGZyb20gJy4uL1V0aWxzL3RleHRGb3JtYXRUb0NvbnRlbnRUeXBlJztcbmltcG9ydCB1c2VTdHlsZVNldCBmcm9tICcuLi9ob29rcy91c2VTdHlsZVNldCc7XG5pbXBvcnQgdXNlU3R5bGVUb0Vtb3Rpb25PYmplY3QgZnJvbSAnLi4vaG9va3MvaW50ZXJuYWwvdXNlU3R5bGVUb0Vtb3Rpb25PYmplY3QnO1xuXG5jb25zdCB7IHVzZUF2YXRhckZvckJvdCwgdXNlQXZhdGFyRm9yVXNlciwgdXNlRGlyZWN0aW9uLCB1c2VMb2NhbGl6ZXIsIHVzZVN0eWxlT3B0aW9ucyB9ID0gaG9va3M7XG5cbmNvbnN0IFJPT1RfU1RZTEUgPSB7XG4gICcmLndlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcCc6IHtcbiAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgZmxleERpcmVjdGlvbjogJ2NvbHVtbicsXG4gICAgTXNPdmVyZmxvd1N0eWxlOiAnbm9uZScsXG4gICAgb3ZlcmZsb3dYOiAnc2Nyb2xsJyxcbiAgICBvdmVyZmxvd1k6ICdoaWRkZW4nLFxuICAgIHBvc2l0aW9uOiAncmVsYXRpdmUnLCAvLyBUaGlzIGlzIHRvIGtlZXAgc2NyZWVuIHJlYWRlciB0ZXh0IGluIHRoZSBkZXN0aW5hdGVkIGFyZWEuXG4gICAgdG91Y2hBY3Rpb246ICdtYW5pcHVsYXRpb24nLFxuICAgIFdlYmtpdE92ZXJmbG93U2Nyb2xsaW5nOiAndG91Y2gnLFxuXG4gICAgJyY6Oi13ZWJraXQtc2Nyb2xsYmFyJzoge1xuICAgICAgZGlzcGxheTogJ25vbmUnXG4gICAgfSxcblxuICAgICcmIC53ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXBfX2FsaWdubWVudC1wYWQnOiB7XG4gICAgICBmbGV4U2hyaW5rOiAwXG4gICAgfSxcblxuICAgICcmIC53ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXAtYXR0YWNobWVudCc6IHtcbiAgICAgIGZsZXg6IDFcbiAgICB9LFxuXG4gICAgJyYgLndlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcF9fYXR0YWNobWVudHMnOiB7XG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICBsaXN0U3R5bGVUeXBlOiAnbm9uZScsXG4gICAgICBtYXJnaW46IDAsXG4gICAgICBwYWRkaW5nOiAwXG4gICAgfSxcblxuICAgICcmIC53ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXBfX2F2YXRhcic6IHtcbiAgICAgIGZsZXhTaHJpbms6IDBcbiAgICB9LFxuXG4gICAgJyYgLndlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcF9fYXZhdGFyLWd1dHRlcic6IHtcbiAgICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICAgIGZsZXhEaXJlY3Rpb246ICdjb2x1bW4nLFxuICAgICAgZmxleFNocmluazogMFxuICAgIH0sXG5cbiAgICAnJiAud2ViY2hhdF9fY2Fyb3VzZWwtZmlsbXN0cmlwX19jb21wbGltZW50YXJ5Jzoge1xuICAgICAgZGlzcGxheTogJ2ZsZXgnXG4gICAgfSxcblxuICAgICcmIC53ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXBfX2NvbXBsaW1lbnRhcnktY29udGVudCc6IHtcbiAgICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICAgIGZsZXhHcm93OiAxLFxuICAgICAgZmxleERpcmVjdGlvbjogJ2NvbHVtbidcbiAgICB9LFxuXG4gICAgJyYgLndlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcF9fY29udGVudCc6IHtcbiAgICAgIGRpc3BsYXk6ICdmbGV4JyxcbiAgICAgIGZsZXhHcm93OiAxLFxuICAgICAgZmxleERpcmVjdGlvbjogJ2NvbHVtbidcbiAgICB9LFxuXG4gICAgJyYgLndlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcF9fZmlsbGVyJzoge1xuICAgICAgZmxleEdyb3c6IDEwMDAwLFxuICAgICAgZmxleFNocmluazogMVxuICAgIH0sXG5cbiAgICAnJiAud2ViY2hhdF9fY2Fyb3VzZWwtZmlsbXN0cmlwX19tYWluJzoge1xuICAgICAgZGlzcGxheTogJ2ZsZXgnXG4gICAgfSxcblxuICAgICcmIC53ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXBfX21lc3NhZ2UnOiB7XG4gICAgICBkaXNwbGF5OiAnZmxleCdcbiAgICB9LFxuXG4gICAgJyYgLndlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcF9fbnViLXBhZCc6IHtcbiAgICAgIGZsZXhTaHJpbms6IDBcbiAgICB9LFxuXG4gICAgJyYgLndlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcF9fc3RhdHVzJzoge1xuICAgICAgZGlzcGxheTogJ2ZsZXgnXG4gICAgfVxuICB9XG59O1xuXG5jb25zdCBjb25uZWN0Q2Fyb3VzZWxGaWxtU3RyaXAgPSAoLi4uc2VsZWN0b3JzKSA9PlxuICBjb25uZWN0VG9XZWJDaGF0KFxuICAgIChcbiAgICAgIHtcbiAgICAgICAgbGFuZ3VhZ2UsXG4gICAgICAgIHN0eWxlU2V0OiB7XG4gICAgICAgICAgb3B0aW9uczogeyBib3RBdmF0YXJJbml0aWFscywgdXNlckF2YXRhckluaXRpYWxzIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHsgYWN0aXZpdHk6IHsgZnJvbTogeyByb2xlIH0gPSB7fSB9ID0ge30gfVxuICAgICkgPT4gKHtcbiAgICAgIGF2YXRhckluaXRpYWxzOiByb2xlID09PSAndXNlcicgPyB1c2VyQXZhdGFySW5pdGlhbHMgOiBib3RBdmF0YXJJbml0aWFscyxcbiAgICAgIGxhbmd1YWdlXG4gICAgfSksXG4gICAgLi4uc2VsZWN0b3JzXG4gICk7XG5cbmNvbnN0IENhcm91c2VsRmlsbVN0cmlwID0gKHtcbiAgYWN0aXZpdHksXG4gIGNsYXNzTmFtZSxcbiAgaGlkZVRpbWVzdGFtcCxcbiAgcmVuZGVyQWN0aXZpdHlTdGF0dXMsXG4gIHJlbmRlckF0dGFjaG1lbnQsXG4gIHJlbmRlckF2YXRhcixcbiAgc2hvd0NhbGxvdXRcbn0pID0+IHtcbiAgY29uc3QgW3sgYnViYmxlTnViT2Zmc2V0LCBidWJibGVOdWJTaXplLCBidWJibGVGcm9tVXNlck51Yk9mZnNldCwgYnViYmxlRnJvbVVzZXJOdWJTaXplIH1dID0gdXNlU3R5bGVPcHRpb25zKCk7XG4gIGNvbnN0IFt7IGNhcm91c2VsRmlsbVN0cmlwOiBjYXJvdXNlbEZpbG1TdHJpcFN0eWxlU2V0IH1dID0gdXNlU3R5bGVTZXQoKTtcbiAgY29uc3QgW3sgaW5pdGlhbHM6IGJvdEluaXRpYWxzIH1dID0gdXNlQXZhdGFyRm9yQm90KCk7XG4gIGNvbnN0IFt7IGluaXRpYWxzOiB1c2VySW5pdGlhbHMgfV0gPSB1c2VBdmF0YXJGb3JVc2VyKCk7XG4gIGNvbnN0IFtkaXJlY3Rpb25dID0gdXNlRGlyZWN0aW9uKCk7XG4gIGNvbnN0IGxvY2FsaXplID0gdXNlTG9jYWxpemVyKCk7XG4gIGNvbnN0IHJvb3RDbGFzc05hbWUgPSB1c2VTdHlsZVRvRW1vdGlvbk9iamVjdCgpKFJPT1RfU1RZTEUpICsgJyc7XG4gIGNvbnN0IHNob3dBY3Rpdml0eVN0YXR1cyA9IHR5cGVvZiByZW5kZXJBY3Rpdml0eVN0YXR1cyA9PT0gJ2Z1bmN0aW9uJztcblxuICBjb25zdCBpdGVtQ29udGFpbmVyQ2FsbGJhY2tSZWYgPSB1c2VJdGVtQ29udGFpbmVyQ2FsbGJhY2tSZWYoKTtcbiAgY29uc3Qgc2Nyb2xsYWJsZUNhbGxiYWNrUmVmID0gdXNlU2Nyb2xsYWJsZUNhbGxiYWNrUmVmKCk7XG5cbiAgY29uc3Qge1xuICAgIGF0dGFjaG1lbnRzID0gW10sXG4gICAgY2hhbm5lbERhdGE6IHsgbWVzc2FnZUJhY2s6IHsgZGlzcGxheVRleHQ6IG1lc3NhZ2VCYWNrRGlzcGxheVRleHQgfSA9IHt9IH0gPSB7fSxcbiAgICBmcm9tOiB7IHJvbGUgfSA9IHt9LFxuICAgIHRleHQsXG4gICAgdGV4dEZvcm1hdFxuICB9ID0gYWN0aXZpdHk7XG5cbiAgY29uc3QgYWN0aXZpdHlEaXNwbGF5VGV4dCA9IG1lc3NhZ2VCYWNrRGlzcGxheVRleHQgfHwgdGV4dDtcbiAgY29uc3QgZnJvbVVzZXIgPSByb2xlID09PSAndXNlcic7XG5cbiAgY29uc3QgZ3JlZXRpbmdBbHQgPSAoXG4gICAgZnJvbVVzZXIgPyBsb2NhbGl6ZSgnQUNUSVZJVFlfWU9VX1NBSURfQUxUJykgOiBsb2NhbGl6ZSgnQUNUSVZJVFlfQk9UX1NBSURfQUxUJywgYm90SW5pdGlhbHMgfHwgJycpXG4gICkucmVwbGFjZSgvXFxzezIsfS9ndSwgJyAnKTtcblxuICBjb25zdCBpbml0aWFscyA9IGZyb21Vc2VyID8gdXNlckluaXRpYWxzIDogYm90SW5pdGlhbHM7XG4gIGNvbnN0IG51Yk9mZnNldCA9IGZyb21Vc2VyID8gYnViYmxlRnJvbVVzZXJOdWJPZmZzZXQgOiBidWJibGVOdWJPZmZzZXQ7XG4gIGNvbnN0IG51YlNpemUgPSBmcm9tVXNlciA/IGJ1YmJsZUZyb21Vc2VyTnViU2l6ZSA6IGJ1YmJsZU51YlNpemU7XG4gIGNvbnN0IG90aGVySW5pdGlhbHMgPSBmcm9tVXNlciA/IGJvdEluaXRpYWxzIDogdXNlckluaXRpYWxzO1xuICBjb25zdCBvdGhlck51YlNpemUgPSBmcm9tVXNlciA/IGJ1YmJsZU51YlNpemUgOiBidWJibGVGcm9tVXNlck51YlNpemU7XG5cbiAgY29uc3QgaGFzQXZhdGFyID0gaW5pdGlhbHMgfHwgdHlwZW9mIGluaXRpYWxzID09PSAnc3RyaW5nJztcbiAgY29uc3QgaGFzT3RoZXJBdmF0YXIgPSBvdGhlckluaXRpYWxzIHx8IHR5cGVvZiBvdGhlckluaXRpYWxzID09PSAnc3RyaW5nJztcbiAgY29uc3QgaGFzTnViID0gdHlwZW9mIG51YlNpemUgPT09ICdudW1iZXInO1xuICBjb25zdCBoYXNPdGhlck51YiA9IHR5cGVvZiBvdGhlck51YlNpemUgPT09ICdudW1iZXInO1xuICBjb25zdCB0b3BBbGlnbmVkQ2FsbG91dCA9IGlzWmVyb09yUG9zaXRpdmUobnViT2Zmc2V0KTtcblxuICBjb25zdCBleHRyYVRyYWlsaW5nID0gIWhhc090aGVyQXZhdGFyICYmIGhhc090aGVyTnViOyAvLyBUaGlzIGlzIGZvciBib3QgbWVzc2FnZSB3aXRoIHVzZXIgbnViIGFuZCBubyB1c2VyIGF2YXRhci4gQW5kIHZpY2UgdmVyc2EuXG5cbiAgY29uc3Qgc2hvd0F2YXRhciA9IHNob3dDYWxsb3V0ICYmIGhhc0F2YXRhciAmJiAhIXJlbmRlckF2YXRhcjtcbiAgY29uc3Qgc2hvd051YiA9IHNob3dDYWxsb3V0ICYmIGhhc051YiAmJiAodG9wQWxpZ25lZENhbGxvdXQgfHwgIWF0dGFjaG1lbnRzLmxlbmd0aCk7XG5cbiAgY29uc3QgaGlkZU51YiA9IGhhc051YiAmJiAhc2hvd051YjtcblxuICByZXR1cm4gKFxuICAgIDxkaXZcbiAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lcyhcbiAgICAgICAgJ3dlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcCcsXG4gICAgICAgIHtcbiAgICAgICAgICAnd2ViY2hhdF9fY2Fyb3VzZWwtZmlsbXN0cmlwLS1leHRyYS10cmFpbGluZyc6IGV4dHJhVHJhaWxpbmcsXG4gICAgICAgICAgJ3dlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcC0taGlkZS1hdmF0YXInOiBoYXNBdmF0YXIgJiYgIXNob3dBdmF0YXIsXG4gICAgICAgICAgJ3dlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcC0taGlkZS1udWInOiBoaWRlTnViLFxuICAgICAgICAgICd3ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXAtLW5vLW1lc3NhZ2UnOiAhYWN0aXZpdHlEaXNwbGF5VGV4dCxcbiAgICAgICAgICAnd2ViY2hhdF9fY2Fyb3VzZWwtZmlsbXN0cmlwLS1ydGwnOiBkaXJlY3Rpb24gPT09ICdydGwnLFxuICAgICAgICAgICd3ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXAtLXNob3ctYXZhdGFyJzogc2hvd0F2YXRhcixcbiAgICAgICAgICAnd2ViY2hhdF9fY2Fyb3VzZWwtZmlsbXN0cmlwLS1zaG93LW51Yic6IHNob3dOdWIsXG4gICAgICAgICAgJ3dlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcC0tdG9wLWNhbGxvdXQnOiB0b3BBbGlnbmVkQ2FsbG91dFxuICAgICAgICB9LFxuICAgICAgICAncmVhY3QtZmlsbV9fZmlsbXN0cmlwJyxcbiAgICAgICAgcm9vdENsYXNzTmFtZSxcbiAgICAgICAgY2Fyb3VzZWxGaWxtU3RyaXBTdHlsZVNldCArICcnLFxuICAgICAgICAoY2xhc3NOYW1lIHx8ICcnKSArICcnXG4gICAgICApfVxuICAgICAgcmVmPXtzY3JvbGxhYmxlQ2FsbGJhY2tSZWZ9XG4gICAgPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXBfX21haW5cIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXBfX2F2YXRhci1ndXR0ZXJcIj57c2hvd0F2YXRhciAmJiByZW5kZXJBdmF0YXIoeyBhY3Rpdml0eSB9KX08L2Rpdj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXBfX2NvbnRlbnRcIj5cbiAgICAgICAgICB7ISFhY3Rpdml0eURpc3BsYXlUZXh0ICYmIChcbiAgICAgICAgICAgIDxkaXYgYXJpYS1yb2xlZGVzY3JpcHRpb249XCJtZXNzYWdlXCIgY2xhc3NOYW1lPVwid2ViY2hhdF9fY2Fyb3VzZWwtZmlsbXN0cmlwX19tZXNzYWdlXCIgcm9sZT1cImdyb3VwXCI+XG4gICAgICAgICAgICAgIDxTY3JlZW5SZWFkZXJUZXh0IHRleHQ9e2dyZWV0aW5nQWx0fSAvPlxuICAgICAgICAgICAgICA8QnViYmxlXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwid2ViY2hhdF9fY2Fyb3VzZWwtZmlsbXN0cmlwX19idWJibGVcIlxuICAgICAgICAgICAgICAgIGZyb21Vc2VyPXtmcm9tVXNlcn1cbiAgICAgICAgICAgICAgICBudWI9e3Nob3dOdWIgfHwgKChoYXNBdmF0YXIgfHwgaGFzTnViKSAmJiAnaGlkZGVuJyl9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7cmVuZGVyQXR0YWNobWVudCh7XG4gICAgICAgICAgICAgICAgICBhY3Rpdml0eSxcbiAgICAgICAgICAgICAgICAgIGF0dGFjaG1lbnQ6IHtcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogYWN0aXZpdHlEaXNwbGF5VGV4dCxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6IHRleHRGb3JtYXRUb0NvbnRlbnRUeXBlKHRleHRGb3JtYXQpXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgIDwvQnViYmxlPlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcF9fZmlsbGVyXCIgLz5cbiAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICl9XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXBfX2NvbXBsaW1lbnRhcnlcIj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2ViY2hhdF9fY2Fyb3VzZWwtZmlsbXN0cmlwX19udWItcGFkXCIgLz5cbiAgICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2ViY2hhdF9fY2Fyb3VzZWwtZmlsbXN0cmlwX19jb21wbGltZW50YXJ5LWNvbnRlbnQgY1wiPlxuICAgICAgICAgICAgICA8dWxcbiAgICAgICAgICAgICAgICBjbGFzc05hbWU9XCJ3ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXBfX2F0dGFjaG1lbnRzIHJlYWN0LWZpbG1fX2ZpbG1zdHJpcF9fbGlzdFwiXG4gICAgICAgICAgICAgICAgcmVmPXtpdGVtQ29udGFpbmVyQ2FsbGJhY2tSZWZ9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7YXR0YWNobWVudHMubWFwKChhdHRhY2htZW50LCBpbmRleCkgPT4gKFxuICAgICAgICAgICAgICAgICAgPENhcm91c2VsRmlsbVN0cmlwQXR0YWNobWVudFxuICAgICAgICAgICAgICAgICAgICBhY3Rpdml0eT17YWN0aXZpdHl9XG4gICAgICAgICAgICAgICAgICAgIGF0dGFjaG1lbnQ9e2F0dGFjaG1lbnR9XG4gICAgICAgICAgICAgICAgICAgIGZyb21Vc2VyPXtmcm9tVXNlcn1cbiAgICAgICAgICAgICAgICAgICAgaGFzQXZhdGFyPXtoYXNBdmF0YXJ9XG4gICAgICAgICAgICAgICAgICAgIGhpZGVOdWI9e2hpZGVOdWJ9XG4gICAgICAgICAgICAgICAgICAgIGluZGV4PXtpbmRleH1cbiAgICAgICAgICAgICAgICAgICAgLyogQXR0YWNobWVudHMgZG8gbm90IGhhdmUgYW4gSUQ7IGl0IGlzIGFsd2F5cyBpbmRleGVkIGJ5IG51bWJlciAqL1xuICAgICAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3Qvbm8tYXJyYXktaW5kZXgta2V5XG4gICAgICAgICAgICAgICAgICAgIGtleT17aW5kZXh9XG4gICAgICAgICAgICAgICAgICAgIHJlbmRlckF0dGFjaG1lbnQ9e3JlbmRlckF0dGFjaG1lbnR9XG4gICAgICAgICAgICAgICAgICAgIHNob3dBdmF0YXI9e3Nob3dBdmF0YXJ9XG4gICAgICAgICAgICAgICAgICAgIHNob3dOdWI9e3Nob3dOdWJ9XG4gICAgICAgICAgICAgICAgICAvPlxuICAgICAgICAgICAgICAgICkpfVxuICAgICAgICAgICAgICA8L3VsPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcF9fYWxpZ25tZW50LXBhZFwiIC8+XG4gICAgICA8L2Rpdj5cbiAgICAgIHtzaG93QWN0aXZpdHlTdGF0dXMgJiYgKFxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndlYmNoYXRfX2Nhcm91c2VsLWZpbG1zdHJpcF9fc3RhdHVzXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19jYXJvdXNlbC1maWxtc3RyaXBfX2F2YXRhci1ndXR0ZXJcIiAvPlxuICAgICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2ViY2hhdF9fY2Fyb3VzZWwtZmlsbXN0cmlwX19udWItcGFkXCIgLz5cbiAgICAgICAgICB7cmVuZGVyQWN0aXZpdHlTdGF0dXMoeyBoaWRlVGltZXN0YW1wIH0pfVxuICAgICAgICA8L2Rpdj5cbiAgICAgICl9XG4gICAgPC9kaXY+XG4gICk7XG59O1xuXG5DYXJvdXNlbEZpbG1TdHJpcC5kZWZhdWx0UHJvcHMgPSB7XG4gIGNsYXNzTmFtZTogJycsXG4gIGhpZGVUaW1lc3RhbXA6IGZhbHNlLFxuICByZW5kZXJBY3Rpdml0eVN0YXR1czogZmFsc2UsXG4gIHJlbmRlckF2YXRhcjogZmFsc2UsXG4gIHNob3dDYWxsb3V0OiBmYWxzZVxufTtcblxuQ2Fyb3VzZWxGaWxtU3RyaXAucHJvcFR5cGVzID0ge1xuICBhY3Rpdml0eTogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICBhdHRhY2htZW50czogUHJvcFR5cGVzLmFycmF5LFxuICAgIGNoYW5uZWxEYXRhOiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgICAgbWVzc2FnZUJhY2s6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICAgIGRpc3BsYXlUZXh0OiBQcm9wVHlwZXMuc3RyaW5nXG4gICAgICB9KVxuICAgIH0pLFxuICAgIGZyb206IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICByb2xlOiBQcm9wVHlwZXMuc3RyaW5nLmlzUmVxdWlyZWRcbiAgICB9KS5pc1JlcXVpcmVkLFxuICAgIHRleHQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgdGV4dEZvcm1hdDogUHJvcFR5cGVzLnN0cmluZyxcbiAgICB0aW1lc3RhbXA6IFByb3BUeXBlcy5zdHJpbmdcbiAgfSkuaXNSZXF1aXJlZCxcbiAgY2xhc3NOYW1lOiBQcm9wVHlwZXMuc3RyaW5nLFxuICBoaWRlVGltZXN0YW1wOiBQcm9wVHlwZXMuYm9vbCxcbiAgcmVuZGVyQWN0aXZpdHlTdGF0dXM6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5vbmVPZihbZmFsc2VdKSwgUHJvcFR5cGVzLmZ1bmNdKSxcbiAgcmVuZGVyQXR0YWNobWVudDogUHJvcFR5cGVzLmZ1bmMuaXNSZXF1aXJlZCxcbiAgcmVuZGVyQXZhdGFyOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMub25lT2YoW2ZhbHNlXSksIFByb3BUeXBlcy5mdW5jXSksXG4gIHNob3dDYWxsb3V0OiBQcm9wVHlwZXMuYm9vbFxufTtcblxuZXhwb3J0IGRlZmF1bHQgQ2Fyb3VzZWxGaWxtU3RyaXA7XG5cbmV4cG9ydCB7IGNvbm5lY3RDYXJvdXNlbEZpbG1TdHJpcCB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFQSxJQUFRQSxlQUFSLEdBQTJGQyw2QkFBM0YsQ0FBUUQsZUFBUjtB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