"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.connectStackedLayout = void 0;

var _botframeworkWebchatApi = require("botframework-webchat-api");

var _classnames = _interopRequireDefault(require("classnames"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireDefault(require("react"));

var _Bubble = _interopRequireDefault(require("./Bubble"));

var _connectToWebChat = _interopRequireDefault(require("../connectToWebChat"));

var _isZeroOrPositive = _interopRequireDefault(require("../Utils/isZeroOrPositive"));

var _ScreenReaderText = _interopRequireDefault(require("../ScreenReaderText"));

var _textFormatToContentType = _interopRequireDefault(require("../Utils/textFormatToContentType"));

var _useStyleSet3 = _interopRequireDefault(require("../hooks/useStyleSet"));

var _useStyleToEmotionObject = _interopRequireDefault(require("../hooks/internal/useStyleToEmotionObject"));

var _useUniqueId = _interopRequireDefault(require("../hooks/internal/useUniqueId"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var useAvatarForBot = _botframeworkWebchatApi.hooks.useAvatarForBot,
    useAvatarForUser = _botframeworkWebchatApi.hooks.useAvatarForUser,
    useLocalizer = _botframeworkWebchatApi.hooks.useLocalizer,
    useStyleOptions = _botframeworkWebchatApi.hooks.useStyleOptions;
var ROOT_STYLE = {
  '&.webchat__stacked-layout': {
    position: 'relative',
    // This is to keep screen reader text in the destinated area.
    '& .webchat__stacked-layout__attachment-row, & .webchat__stacked-layout__main, & .webchat__stacked-layout__message-row, & .webchat__stacked-layout__status': {
      display: 'flex'
    },
    '& .webchat__stacked-layout__alignment-pad': {
      flexShrink: 0
    },
    '& .webchat__stacked-layout__attachment': {
      width: '100%'
    },
    '& .webchat__stacked-layout__avatar-gutter': {
      display: 'flex',
      flexDirection: 'column',
      flexShrink: 0
    },
    '&.webchat__stacked-layout--from-user': {
      '& .webchat__stacked-layout__attachment-row, & .webchat__stacked-layout__main, & .webchat__stacked-layout__message-row, & .webchat__stacked-layout__status': {
        flexDirection: 'row-reverse'
      }
    },
    '& .webchat__stacked-layout__content': {
      flex: 1,
      // This is for bottom aligning an avatar with a message bubble shorter than the avatar.
      // Related to the test at activityGrouping.avatarMiddleware.atBottom.js.
      display: 'flex',
      flexDirection: 'column',
      // This "overflow: hidden" is to make sure text overflow will get clipped correctly.
      // Related to the test at basic.js "long URLs with keep-all".
      overflow: 'hidden'
    },
    '& .webchat__stacked-layout__nub-pad': {
      flexShrink: 0
    }
  }
};

var connectStackedLayout = function connectStackedLayout() {
  for (var _len = arguments.length, selectors = new Array(_len), _key = 0; _key < _len; _key++) {
    selectors[_key] = arguments[_key];
  }

  return _connectToWebChat.default.apply(void 0, [function (_ref, _ref2) {
    var language = _ref.language,
        _ref$styleSet$options = _ref.styleSet.options,
        botAvatarInitials = _ref$styleSet$options.botAvatarInitials,
        userAvatarInitials = _ref$styleSet$options.userAvatarInitials;
    var _ref2$activity = _ref2.activity;
    _ref2$activity = _ref2$activity === void 0 ? {} : _ref2$activity;
    var _ref2$activity$from = _ref2$activity.from;
    _ref2$activity$from = _ref2$activity$from === void 0 ? {} : _ref2$activity$from;
    var _ref2$activity$from$r = _ref2$activity$from.role,
        role = _ref2$activity$from$r === void 0 ? undefined : _ref2$activity$from$r;
    return {
      avatarInitials: role === 'user' ? userAvatarInitials : botAvatarInitials,
      language: language,
      // TODO: [P4] We want to deprecate botAvatarInitials/userAvatarInitials because they are not as helpful as avatarInitials
      botAvatarInitials: botAvatarInitials,
      userAvatarInitials: userAvatarInitials
    };
  }].concat(selectors));
};

exports.connectStackedLayout = connectStackedLayout;

var StackedLayout = function StackedLayout(_ref3) {
  var _activity$channelData, _activity$channelData2;

  var activity = _ref3.activity,
      hideTimestamp = _ref3.hideTimestamp,
      renderActivityStatus = _ref3.renderActivityStatus,
      renderAttachment = _ref3.renderAttachment,
      renderAvatar = _ref3.renderAvatar,
      showCallout = _ref3.showCallout;

  var _useStyleOptions = useStyleOptions(),
      _useStyleOptions2 = _slicedToArray(_useStyleOptions, 1),
      styleOptions = _useStyleOptions2[0];

  var _useAvatarForBot = useAvatarForBot(),
      _useAvatarForBot2 = _slicedToArray(_useAvatarForBot, 1),
      botInitials = _useAvatarForBot2[0].initials;

  var _useAvatarForUser = useAvatarForUser(),
      _useAvatarForUser2 = _slicedToArray(_useAvatarForUser, 1),
      userInitials = _useAvatarForUser2[0].initials;

  var _useStyleSet = (0, _useStyleSet3.default)(),
      _useStyleSet2 = _slicedToArray(_useStyleSet, 1),
      stackedLayoutStyleSet = _useStyleSet2[0].stackedLayout;

  var ariaLabelId = (0, _useUniqueId.default)('webchat__stacked-layout__id');
  var localize = useLocalizer();
  var rootClassName = (0, _useStyleToEmotionObject.default)()(ROOT_STYLE) + '';
  var bubbleNubOffset = styleOptions.bubbleNubOffset,
      bubbleNubSize = styleOptions.bubbleNubSize,
      bubbleFromUserNubOffset = styleOptions.bubbleFromUserNubOffset,
      bubbleFromUserNubSize = styleOptions.bubbleFromUserNubSize;
  var isMessage = activity.type === 'message';
  var attachments = isMessage && activity.attachments || [];
  var fromUser = activity.from.role === 'user';
  var messageBackDisplayText = isMessage && ((_activity$channelData = activity.channelData) === null || _activity$channelData === void 0 ? void 0 : (_activity$channelData2 = _activity$channelData.messageBack) === null || _activity$channelData2 === void 0 ? void 0 : _activity$channelData2.displayText) || '';
  var activityDisplayText = isMessage ? messageBackDisplayText || activity.text : '';
  var attachedAlt = localize(fromUser ? 'ACTIVITY_YOU_ATTACHED_ALT' : 'ACTIVITY_BOT_ATTACHED_ALT');
  var greetingAlt = (fromUser ? localize('ACTIVITY_YOU_SAID_ALT') : localize('ACTIVITY_BOT_SAID_ALT', botInitials || '')).replace(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]{2,}/g, ' ');
  var initials = fromUser ? userInitials : botInitials;
  var nubOffset = fromUser ? bubbleFromUserNubOffset : bubbleNubOffset;
  var nubSize = fromUser ? bubbleFromUserNubSize : bubbleNubSize;
  var otherInitials = fromUser ? botInitials : userInitials;
  var otherNubSize = fromUser ? bubbleNubSize : bubbleFromUserNubSize;
  var hasAvatar = initials || typeof initials === 'string';
  var hasOtherAvatar = otherInitials || typeof otherInitials === 'string';
  var hasNub = typeof nubSize === 'number';
  var hasOtherNub = typeof otherNubSize === 'number';
  var topAlignedCallout = (0, _isZeroOrPositive.default)(nubOffset);
  var extraTrailing = !hasOtherAvatar && hasOtherNub; // This is for bot message with user nub and no user avatar. And vice versa.

  var showAvatar = showCallout && hasAvatar && !!renderAvatar;
  var showNub = showCallout && hasNub && (topAlignedCallout || !(attachments !== null && attachments !== void 0 && attachments.length));
  return /*#__PURE__*/_react.default.createElement("div", {
    "aria-labelledby": activityDisplayText ? ariaLabelId : undefined,
    className: (0, _classnames.default)('webchat__stacked-layout', rootClassName, stackedLayoutStyleSet + '', {
      'webchat__stacked-layout--extra-trailing': extraTrailing,
      'webchat__stacked-layout--from-user': fromUser,
      'webchat__stacked-layout--hide-avatar': hasAvatar && !showAvatar,
      'webchat__stacked-layout--hide-nub': hasNub && !showNub,
      'webchat__stacked-layout--no-message': !activityDisplayText,
      'webchat__stacked-layout--show-avatar': showAvatar,
      'webchat__stacked-layout--show-nub': showNub,
      'webchat__stacked-layout--top-callout': topAlignedCallout
    })
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__stacked-layout__main"
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__stacked-layout__avatar-gutter"
  }, showAvatar && renderAvatar()), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__stacked-layout__content"
  }, !!activityDisplayText && /*#__PURE__*/_react.default.createElement("div", {
    "aria-roledescription": "message",
    className: "webchat__stacked-layout__message-row" // Disable "Prop `id` is forbidden on DOM Nodes" rule because we are using the ID prop for accessibility.

    /* eslint-disable-next-line react/forbid-dom-props */
    ,
    id: ariaLabelId,
    role: "group"
  }, /*#__PURE__*/_react.default.createElement(_ScreenReaderText.default, {
    text: greetingAlt
  }), /*#__PURE__*/_react.default.createElement(_Bubble.default, {
    className: "webchat__stacked-layout__message",
    fromUser: fromUser,
    nub: showNub || (hasAvatar || hasNub ? 'hidden' : false)
  }, renderAttachment({
    activity: activity,
    attachment: isMessage ? {
      content: activityDisplayText,
      contentType: (0, _textFormatToContentType.default)(activity.textFormat)
    } : undefined
  }))), attachments.map(function (attachment, index) {
    return /*#__PURE__*/_react.default.createElement("div", {
      "aria-roledescription": "attachment",
      className: (0, _classnames.default)('webchat__stacked-layout__attachment-row', {
        'webchat__stacked-layout__attachment-row--first': !index
      })
      /* attachments do not have an ID, it is always indexed by number */

      /* eslint-disable-next-line react/no-array-index-key */
      ,
      key: index,
      role: "group"
    }, /*#__PURE__*/_react.default.createElement(_ScreenReaderText.default, {
      text: attachedAlt
    }), /*#__PURE__*/_react.default.createElement(_Bubble.default, {
      className: "webchat__stacked-layout__attachment",
      fromUser: fromUser
      /* eslint-disable-next-line react/no-array-index-key */
      ,
      key: index,
      nub: hasAvatar || hasNub ? 'hidden' : false
    }, renderAttachment({
      activity: activity,
      attachment: attachment
    })));
  })), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__stacked-layout__alignment-pad"
  })), typeof renderActivityStatus === 'function' && /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__stacked-layout__status"
  }, /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__stacked-layout__avatar-gutter"
  }), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__stacked-layout__nub-pad"
  }), renderActivityStatus({
    hideTimestamp: hideTimestamp
  }), /*#__PURE__*/_react.default.createElement("div", {
    className: "webchat__stacked-layout__alignment-pad"
  })));
};

StackedLayout.defaultProps = {
  hideTimestamp: false,
  renderActivityStatus: function renderActivityStatus() {
    return false;
  },
  renderAvatar: undefined,
  showCallout: true
};
StackedLayout.propTypes = {
  // PropTypes cannot fully capture TypeScript types.
  // @ts-ignore
  activity: _propTypes.default.shape({
    attachments: _propTypes.default.array,
    channelData: _propTypes.default.shape({
      messageBack: _propTypes.default.shape({
        displayText: _propTypes.default.string
      })
    }),
    from: _propTypes.default.shape({
      role: _propTypes.default.string.isRequired
    }).isRequired,
    text: _propTypes.default.string,
    textFormat: _propTypes.default.oneOf(['markdown', 'plain', 'xml']),
    timestamp: _propTypes.default.string,
    type: _propTypes.default.string.isRequired
  }).isRequired,
  hideTimestamp: _propTypes.default.bool,
  // PropTypes cannot validate precisely with its TypeScript counterpart.
  // @ts-ignore
  renderActivityStatus: _propTypes.default.oneOfType([_propTypes.default.oneOf([false]), _propTypes.default.func]),
  renderAttachment: _propTypes.default.func.isRequired,
  // PropTypes cannot validate precisely with its TypeScript counterpart.
  // @ts-ignore
  renderAvatar: _propTypes.default.oneOfType([_propTypes.default.oneOf([false]), _propTypes.default.func]),
  showCallout: _propTypes.default.bool
};
var _default = StackedLayout;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ1c2VBdmF0YXJGb3JCb3QiLCJob29rcyIsInVzZUF2YXRhckZvclVzZXIiLCJ1c2VMb2NhbGl6ZXIiLCJ1c2VTdHlsZU9wdGlvbnMiLCJST09UX1NUWUxFIiwicG9zaXRpb24iLCJkaXNwbGF5IiwiZmxleFNocmluayIsIndpZHRoIiwiZmxleERpcmVjdGlvbiIsImZsZXgiLCJvdmVyZmxvdyIsImNvbm5lY3RTdGFja2VkTGF5b3V0Iiwic2VsZWN0b3JzIiwiY29ubmVjdFRvV2ViQ2hhdCIsImxhbmd1YWdlIiwic3R5bGVTZXQiLCJvcHRpb25zIiwiYm90QXZhdGFySW5pdGlhbHMiLCJ1c2VyQXZhdGFySW5pdGlhbHMiLCJhY3Rpdml0eSIsImZyb20iLCJyb2xlIiwidW5kZWZpbmVkIiwiYXZhdGFySW5pdGlhbHMiLCJTdGFja2VkTGF5b3V0IiwiaGlkZVRpbWVzdGFtcCIsInJlbmRlckFjdGl2aXR5U3RhdHVzIiwicmVuZGVyQXR0YWNobWVudCIsInJlbmRlckF2YXRhciIsInNob3dDYWxsb3V0Iiwic3R5bGVPcHRpb25zIiwiYm90SW5pdGlhbHMiLCJpbml0aWFscyIsInVzZXJJbml0aWFscyIsInVzZVN0eWxlU2V0Iiwic3RhY2tlZExheW91dFN0eWxlU2V0Iiwic3RhY2tlZExheW91dCIsImFyaWFMYWJlbElkIiwidXNlVW5pcXVlSWQiLCJsb2NhbGl6ZSIsInJvb3RDbGFzc05hbWUiLCJ1c2VTdHlsZVRvRW1vdGlvbk9iamVjdCIsImJ1YmJsZU51Yk9mZnNldCIsImJ1YmJsZU51YlNpemUiLCJidWJibGVGcm9tVXNlck51Yk9mZnNldCIsImJ1YmJsZUZyb21Vc2VyTnViU2l6ZSIsImlzTWVzc2FnZSIsInR5cGUiLCJhdHRhY2htZW50cyIsImZyb21Vc2VyIiwibWVzc2FnZUJhY2tEaXNwbGF5VGV4dCIsImNoYW5uZWxEYXRhIiwibWVzc2FnZUJhY2siLCJkaXNwbGF5VGV4dCIsImFjdGl2aXR5RGlzcGxheVRleHQiLCJ0ZXh0IiwiYXR0YWNoZWRBbHQiLCJncmVldGluZ0FsdCIsInJlcGxhY2UiLCJudWJPZmZzZXQiLCJudWJTaXplIiwib3RoZXJJbml0aWFscyIsIm90aGVyTnViU2l6ZSIsImhhc0F2YXRhciIsImhhc090aGVyQXZhdGFyIiwiaGFzTnViIiwiaGFzT3RoZXJOdWIiLCJ0b3BBbGlnbmVkQ2FsbG91dCIsImlzWmVyb09yUG9zaXRpdmUiLCJleHRyYVRyYWlsaW5nIiwic2hvd0F2YXRhciIsInNob3dOdWIiLCJsZW5ndGgiLCJjbGFzc05hbWVzIiwiYXR0YWNobWVudCIsImNvbnRlbnQiLCJjb250ZW50VHlwZSIsInRleHRGb3JtYXRUb0NvbnRlbnRUeXBlIiwidGV4dEZvcm1hdCIsIm1hcCIsImluZGV4IiwiZGVmYXVsdFByb3BzIiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwic2hhcGUiLCJhcnJheSIsInN0cmluZyIsImlzUmVxdWlyZWQiLCJvbmVPZiIsInRpbWVzdGFtcCIsImJvb2wiLCJvbmVPZlR5cGUiLCJmdW5jIl0sInNvdXJjZVJvb3QiOiJjb21wb25lbnQ6Ly8vIiwic291cmNlcyI6WyIuLi8uLi9zcmMvQWN0aXZpdHkvU3RhY2tlZExheW91dC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50IGNvbXBsZXhpdHk6IFtcImVycm9yXCIsIDUwXSAqL1xuXG5pbXBvcnQgeyBob29rcyB9IGZyb20gJ2JvdGZyYW1ld29yay13ZWJjaGF0LWFwaSc7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuXG5pbXBvcnQgQnViYmxlIGZyb20gJy4vQnViYmxlJztcbmltcG9ydCBjb25uZWN0VG9XZWJDaGF0IGZyb20gJy4uL2Nvbm5lY3RUb1dlYkNoYXQnO1xuaW1wb3J0IGlzWmVyb09yUG9zaXRpdmUgZnJvbSAnLi4vVXRpbHMvaXNaZXJvT3JQb3NpdGl2ZSc7XG5pbXBvcnQgU2NyZWVuUmVhZGVyVGV4dCBmcm9tICcuLi9TY3JlZW5SZWFkZXJUZXh0JztcbmltcG9ydCB0ZXh0Rm9ybWF0VG9Db250ZW50VHlwZSBmcm9tICcuLi9VdGlscy90ZXh0Rm9ybWF0VG9Db250ZW50VHlwZSc7XG5pbXBvcnQgdXNlU3R5bGVTZXQgZnJvbSAnLi4vaG9va3MvdXNlU3R5bGVTZXQnO1xuaW1wb3J0IHVzZVN0eWxlVG9FbW90aW9uT2JqZWN0IGZyb20gJy4uL2hvb2tzL2ludGVybmFsL3VzZVN0eWxlVG9FbW90aW9uT2JqZWN0JztcbmltcG9ydCB1c2VVbmlxdWVJZCBmcm9tICcuLi9ob29rcy9pbnRlcm5hbC91c2VVbmlxdWVJZCc7XG5cbmltcG9ydCB0eXBlIHsgRkMsIFJlYWN0Tm9kZSB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB0eXBlIHsgUmVuZGVyQXR0YWNobWVudCB9IGZyb20gJ2JvdGZyYW1ld29yay13ZWJjaGF0LWFwaSc7XG5pbXBvcnQgdHlwZSB7IFdlYkNoYXRBY3Rpdml0eSB9IGZyb20gJ2JvdGZyYW1ld29yay13ZWJjaGF0LWNvcmUnO1xuXG5jb25zdCB7IHVzZUF2YXRhckZvckJvdCwgdXNlQXZhdGFyRm9yVXNlciwgdXNlTG9jYWxpemVyLCB1c2VTdHlsZU9wdGlvbnMgfSA9IGhvb2tzO1xuXG5jb25zdCBST09UX1NUWUxFID0ge1xuICAnJi53ZWJjaGF0X19zdGFja2VkLWxheW91dCc6IHtcbiAgICBwb3NpdGlvbjogJ3JlbGF0aXZlJywgLy8gVGhpcyBpcyB0byBrZWVwIHNjcmVlbiByZWFkZXIgdGV4dCBpbiB0aGUgZGVzdGluYXRlZCBhcmVhLlxuXG4gICAgJyYgLndlYmNoYXRfX3N0YWNrZWQtbGF5b3V0X19hdHRhY2htZW50LXJvdywgJiAud2ViY2hhdF9fc3RhY2tlZC1sYXlvdXRfX21haW4sICYgLndlYmNoYXRfX3N0YWNrZWQtbGF5b3V0X19tZXNzYWdlLXJvdywgJiAud2ViY2hhdF9fc3RhY2tlZC1sYXlvdXRfX3N0YXR1cyc6XG4gICAgICB7XG4gICAgICAgIGRpc3BsYXk6ICdmbGV4J1xuICAgICAgfSxcblxuICAgICcmIC53ZWJjaGF0X19zdGFja2VkLWxheW91dF9fYWxpZ25tZW50LXBhZCc6IHtcbiAgICAgIGZsZXhTaHJpbms6IDBcbiAgICB9LFxuXG4gICAgJyYgLndlYmNoYXRfX3N0YWNrZWQtbGF5b3V0X19hdHRhY2htZW50Jzoge1xuICAgICAgd2lkdGg6ICcxMDAlJ1xuICAgIH0sXG5cbiAgICAnJiAud2ViY2hhdF9fc3RhY2tlZC1sYXlvdXRfX2F2YXRhci1ndXR0ZXInOiB7XG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICBmbGV4RGlyZWN0aW9uOiAnY29sdW1uJyxcbiAgICAgIGZsZXhTaHJpbms6IDBcbiAgICB9LFxuXG4gICAgJyYud2ViY2hhdF9fc3RhY2tlZC1sYXlvdXQtLWZyb20tdXNlcic6IHtcbiAgICAgICcmIC53ZWJjaGF0X19zdGFja2VkLWxheW91dF9fYXR0YWNobWVudC1yb3csICYgLndlYmNoYXRfX3N0YWNrZWQtbGF5b3V0X19tYWluLCAmIC53ZWJjaGF0X19zdGFja2VkLWxheW91dF9fbWVzc2FnZS1yb3csICYgLndlYmNoYXRfX3N0YWNrZWQtbGF5b3V0X19zdGF0dXMnOlxuICAgICAgICB7XG4gICAgICAgICAgZmxleERpcmVjdGlvbjogJ3Jvdy1yZXZlcnNlJ1xuICAgICAgICB9XG4gICAgfSxcblxuICAgICcmIC53ZWJjaGF0X19zdGFja2VkLWxheW91dF9fY29udGVudCc6IHtcbiAgICAgIGZsZXg6IDEsXG5cbiAgICAgIC8vIFRoaXMgaXMgZm9yIGJvdHRvbSBhbGlnbmluZyBhbiBhdmF0YXIgd2l0aCBhIG1lc3NhZ2UgYnViYmxlIHNob3J0ZXIgdGhhbiB0aGUgYXZhdGFyLlxuICAgICAgLy8gUmVsYXRlZCB0byB0aGUgdGVzdCBhdCBhY3Rpdml0eUdyb3VwaW5nLmF2YXRhck1pZGRsZXdhcmUuYXRCb3R0b20uanMuXG4gICAgICBkaXNwbGF5OiAnZmxleCcsXG4gICAgICBmbGV4RGlyZWN0aW9uOiAnY29sdW1uJyxcblxuICAgICAgLy8gVGhpcyBcIm92ZXJmbG93OiBoaWRkZW5cIiBpcyB0byBtYWtlIHN1cmUgdGV4dCBvdmVyZmxvdyB3aWxsIGdldCBjbGlwcGVkIGNvcnJlY3RseS5cbiAgICAgIC8vIFJlbGF0ZWQgdG8gdGhlIHRlc3QgYXQgYmFzaWMuanMgXCJsb25nIFVSTHMgd2l0aCBrZWVwLWFsbFwiLlxuICAgICAgb3ZlcmZsb3c6ICdoaWRkZW4nXG4gICAgfSxcblxuICAgICcmIC53ZWJjaGF0X19zdGFja2VkLWxheW91dF9fbnViLXBhZCc6IHtcbiAgICAgIGZsZXhTaHJpbms6IDBcbiAgICB9XG4gIH1cbn07XG5cbmNvbnN0IGNvbm5lY3RTdGFja2VkTGF5b3V0ID0gKC4uLnNlbGVjdG9ycykgPT5cbiAgY29ubmVjdFRvV2ViQ2hhdChcbiAgICAoXG4gICAgICB7XG4gICAgICAgIGxhbmd1YWdlLFxuICAgICAgICBzdHlsZVNldDoge1xuICAgICAgICAgIG9wdGlvbnM6IHsgYm90QXZhdGFySW5pdGlhbHMsIHVzZXJBdmF0YXJJbml0aWFscyB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB7IGFjdGl2aXR5OiB7IGZyb206IHsgcm9sZSA9IHVuZGVmaW5lZCB9ID0ge30gfSA9IHt9IH1cbiAgICApID0+ICh7XG4gICAgICBhdmF0YXJJbml0aWFsczogcm9sZSA9PT0gJ3VzZXInID8gdXNlckF2YXRhckluaXRpYWxzIDogYm90QXZhdGFySW5pdGlhbHMsXG4gICAgICBsYW5ndWFnZSxcblxuICAgICAgLy8gVE9ETzogW1A0XSBXZSB3YW50IHRvIGRlcHJlY2F0ZSBib3RBdmF0YXJJbml0aWFscy91c2VyQXZhdGFySW5pdGlhbHMgYmVjYXVzZSB0aGV5IGFyZSBub3QgYXMgaGVscGZ1bCBhcyBhdmF0YXJJbml0aWFsc1xuICAgICAgYm90QXZhdGFySW5pdGlhbHMsXG4gICAgICB1c2VyQXZhdGFySW5pdGlhbHNcbiAgICB9KSxcbiAgICAuLi5zZWxlY3RvcnNcbiAgKTtcblxudHlwZSBTdGFja2VkTGF5b3V0UHJvcHMgPSB7XG4gIGFjdGl2aXR5OiBXZWJDaGF0QWN0aXZpdHk7XG4gIGhpZGVUaW1lc3RhbXA/OiBib29sZWFuO1xuICByZW5kZXJBY3Rpdml0eVN0YXR1cz86IChvcHRpb25zOiB7IGhpZGVUaW1lc3RhbXA6IGJvb2xlYW4gfSkgPT4gUmVhY3ROb2RlO1xuICByZW5kZXJBdHRhY2htZW50PzogUmVuZGVyQXR0YWNobWVudDtcbiAgcmVuZGVyQXZhdGFyPzogZmFsc2UgfCAoKCkgPT4gRXhjbHVkZTxSZWFjdE5vZGUsIGJvb2xlYW4gfCBudWxsIHwgdW5kZWZpbmVkPik7XG4gIHNob3dDYWxsb3V0PzogYm9vbGVhbjtcbn07XG5cbmNvbnN0IFN0YWNrZWRMYXlvdXQ6IEZDPFN0YWNrZWRMYXlvdXRQcm9wcz4gPSAoe1xuICBhY3Rpdml0eSxcbiAgaGlkZVRpbWVzdGFtcCxcbiAgcmVuZGVyQWN0aXZpdHlTdGF0dXMsXG4gIHJlbmRlckF0dGFjaG1lbnQsXG4gIHJlbmRlckF2YXRhcixcbiAgc2hvd0NhbGxvdXRcbn0pID0+IHtcbiAgY29uc3QgW3N0eWxlT3B0aW9uc10gPSB1c2VTdHlsZU9wdGlvbnMoKTtcbiAgY29uc3QgW3sgaW5pdGlhbHM6IGJvdEluaXRpYWxzIH1dID0gdXNlQXZhdGFyRm9yQm90KCk7XG4gIGNvbnN0IFt7IGluaXRpYWxzOiB1c2VySW5pdGlhbHMgfV0gPSB1c2VBdmF0YXJGb3JVc2VyKCk7XG4gIGNvbnN0IFt7IHN0YWNrZWRMYXlvdXQ6IHN0YWNrZWRMYXlvdXRTdHlsZVNldCB9XSA9IHVzZVN0eWxlU2V0KCk7XG4gIGNvbnN0IGFyaWFMYWJlbElkID0gdXNlVW5pcXVlSWQoJ3dlYmNoYXRfX3N0YWNrZWQtbGF5b3V0X19pZCcpO1xuICBjb25zdCBsb2NhbGl6ZSA9IHVzZUxvY2FsaXplcigpO1xuICBjb25zdCByb290Q2xhc3NOYW1lID0gdXNlU3R5bGVUb0Vtb3Rpb25PYmplY3QoKShST09UX1NUWUxFKSArICcnO1xuXG4gIGNvbnN0IHsgYnViYmxlTnViT2Zmc2V0LCBidWJibGVOdWJTaXplLCBidWJibGVGcm9tVXNlck51Yk9mZnNldCwgYnViYmxlRnJvbVVzZXJOdWJTaXplIH0gPSBzdHlsZU9wdGlvbnM7XG5cbiAgY29uc3QgaXNNZXNzYWdlID0gYWN0aXZpdHkudHlwZSA9PT0gJ21lc3NhZ2UnO1xuXG4gIGNvbnN0IGF0dGFjaG1lbnRzID0gKGlzTWVzc2FnZSAmJiBhY3Rpdml0eS5hdHRhY2htZW50cykgfHwgW107XG4gIGNvbnN0IGZyb21Vc2VyID0gYWN0aXZpdHkuZnJvbS5yb2xlID09PSAndXNlcic7XG4gIGNvbnN0IG1lc3NhZ2VCYWNrRGlzcGxheVRleHQ6IHN0cmluZyA9IChpc01lc3NhZ2UgJiYgYWN0aXZpdHkuY2hhbm5lbERhdGE/Lm1lc3NhZ2VCYWNrPy5kaXNwbGF5VGV4dCkgfHwgJyc7XG5cbiAgY29uc3QgYWN0aXZpdHlEaXNwbGF5VGV4dCA9IGlzTWVzc2FnZSA/IG1lc3NhZ2VCYWNrRGlzcGxheVRleHQgfHwgYWN0aXZpdHkudGV4dCA6ICcnO1xuICBjb25zdCBhdHRhY2hlZEFsdCA9IGxvY2FsaXplKGZyb21Vc2VyID8gJ0FDVElWSVRZX1lPVV9BVFRBQ0hFRF9BTFQnIDogJ0FDVElWSVRZX0JPVF9BVFRBQ0hFRF9BTFQnKTtcbiAgY29uc3QgZ3JlZXRpbmdBbHQgPSAoXG4gICAgZnJvbVVzZXIgPyBsb2NhbGl6ZSgnQUNUSVZJVFlfWU9VX1NBSURfQUxUJykgOiBsb2NhbGl6ZSgnQUNUSVZJVFlfQk9UX1NBSURfQUxUJywgYm90SW5pdGlhbHMgfHwgJycpXG4gICkucmVwbGFjZSgvXFxzezIsfS9ndSwgJyAnKTtcblxuICBjb25zdCBpbml0aWFscyA9IGZyb21Vc2VyID8gdXNlckluaXRpYWxzIDogYm90SW5pdGlhbHM7XG4gIGNvbnN0IG51Yk9mZnNldCA9IGZyb21Vc2VyID8gYnViYmxlRnJvbVVzZXJOdWJPZmZzZXQgOiBidWJibGVOdWJPZmZzZXQ7XG4gIGNvbnN0IG51YlNpemUgPSBmcm9tVXNlciA/IGJ1YmJsZUZyb21Vc2VyTnViU2l6ZSA6IGJ1YmJsZU51YlNpemU7XG4gIGNvbnN0IG90aGVySW5pdGlhbHMgPSBmcm9tVXNlciA/IGJvdEluaXRpYWxzIDogdXNlckluaXRpYWxzO1xuICBjb25zdCBvdGhlck51YlNpemUgPSBmcm9tVXNlciA/IGJ1YmJsZU51YlNpemUgOiBidWJibGVGcm9tVXNlck51YlNpemU7XG5cbiAgY29uc3QgaGFzQXZhdGFyID0gaW5pdGlhbHMgfHwgdHlwZW9mIGluaXRpYWxzID09PSAnc3RyaW5nJztcbiAgY29uc3QgaGFzT3RoZXJBdmF0YXIgPSBvdGhlckluaXRpYWxzIHx8IHR5cGVvZiBvdGhlckluaXRpYWxzID09PSAnc3RyaW5nJztcbiAgY29uc3QgaGFzTnViID0gdHlwZW9mIG51YlNpemUgPT09ICdudW1iZXInO1xuICBjb25zdCBoYXNPdGhlck51YiA9IHR5cGVvZiBvdGhlck51YlNpemUgPT09ICdudW1iZXInO1xuICBjb25zdCB0b3BBbGlnbmVkQ2FsbG91dCA9IGlzWmVyb09yUG9zaXRpdmUobnViT2Zmc2V0KTtcblxuICBjb25zdCBleHRyYVRyYWlsaW5nID0gIWhhc090aGVyQXZhdGFyICYmIGhhc090aGVyTnViOyAvLyBUaGlzIGlzIGZvciBib3QgbWVzc2FnZSB3aXRoIHVzZXIgbnViIGFuZCBubyB1c2VyIGF2YXRhci4gQW5kIHZpY2UgdmVyc2EuXG5cbiAgY29uc3Qgc2hvd0F2YXRhciA9IHNob3dDYWxsb3V0ICYmIGhhc0F2YXRhciAmJiAhIXJlbmRlckF2YXRhcjtcbiAgY29uc3Qgc2hvd051YiA9IHNob3dDYWxsb3V0ICYmIGhhc051YiAmJiAodG9wQWxpZ25lZENhbGxvdXQgfHwgIWF0dGFjaG1lbnRzPy5sZW5ndGgpO1xuXG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgYXJpYS1sYWJlbGxlZGJ5PXthY3Rpdml0eURpc3BsYXlUZXh0ID8gYXJpYUxhYmVsSWQgOiB1bmRlZmluZWR9XG4gICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMoJ3dlYmNoYXRfX3N0YWNrZWQtbGF5b3V0Jywgcm9vdENsYXNzTmFtZSwgc3RhY2tlZExheW91dFN0eWxlU2V0ICsgJycsIHtcbiAgICAgICAgJ3dlYmNoYXRfX3N0YWNrZWQtbGF5b3V0LS1leHRyYS10cmFpbGluZyc6IGV4dHJhVHJhaWxpbmcsXG4gICAgICAgICd3ZWJjaGF0X19zdGFja2VkLWxheW91dC0tZnJvbS11c2VyJzogZnJvbVVzZXIsXG4gICAgICAgICd3ZWJjaGF0X19zdGFja2VkLWxheW91dC0taGlkZS1hdmF0YXInOiBoYXNBdmF0YXIgJiYgIXNob3dBdmF0YXIsXG4gICAgICAgICd3ZWJjaGF0X19zdGFja2VkLWxheW91dC0taGlkZS1udWInOiBoYXNOdWIgJiYgIXNob3dOdWIsXG4gICAgICAgICd3ZWJjaGF0X19zdGFja2VkLWxheW91dC0tbm8tbWVzc2FnZSc6ICFhY3Rpdml0eURpc3BsYXlUZXh0LFxuICAgICAgICAnd2ViY2hhdF9fc3RhY2tlZC1sYXlvdXQtLXNob3ctYXZhdGFyJzogc2hvd0F2YXRhcixcbiAgICAgICAgJ3dlYmNoYXRfX3N0YWNrZWQtbGF5b3V0LS1zaG93LW51Yic6IHNob3dOdWIsXG4gICAgICAgICd3ZWJjaGF0X19zdGFja2VkLWxheW91dC0tdG9wLWNhbGxvdXQnOiB0b3BBbGlnbmVkQ2FsbG91dFxuICAgICAgfSl9XG4gICAgPlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19zdGFja2VkLWxheW91dF9fbWFpblwiPlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndlYmNoYXRfX3N0YWNrZWQtbGF5b3V0X19hdmF0YXItZ3V0dGVyXCI+e3Nob3dBdmF0YXIgJiYgcmVuZGVyQXZhdGFyKCl9PC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2ViY2hhdF9fc3RhY2tlZC1sYXlvdXRfX2NvbnRlbnRcIj5cbiAgICAgICAgICB7ISFhY3Rpdml0eURpc3BsYXlUZXh0ICYmIChcbiAgICAgICAgICAgIDxkaXZcbiAgICAgICAgICAgICAgYXJpYS1yb2xlZGVzY3JpcHRpb249XCJtZXNzYWdlXCJcbiAgICAgICAgICAgICAgY2xhc3NOYW1lPVwid2ViY2hhdF9fc3RhY2tlZC1sYXlvdXRfX21lc3NhZ2Utcm93XCJcbiAgICAgICAgICAgICAgLy8gRGlzYWJsZSBcIlByb3AgYGlkYCBpcyBmb3JiaWRkZW4gb24gRE9NIE5vZGVzXCIgcnVsZSBiZWNhdXNlIHdlIGFyZSB1c2luZyB0aGUgSUQgcHJvcCBmb3IgYWNjZXNzaWJpbGl0eS5cbiAgICAgICAgICAgICAgLyogZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHJlYWN0L2ZvcmJpZC1kb20tcHJvcHMgKi9cbiAgICAgICAgICAgICAgaWQ9e2FyaWFMYWJlbElkfVxuICAgICAgICAgICAgICByb2xlPVwiZ3JvdXBcIlxuICAgICAgICAgICAgPlxuICAgICAgICAgICAgICA8U2NyZWVuUmVhZGVyVGV4dCB0ZXh0PXtncmVldGluZ0FsdH0gLz5cbiAgICAgICAgICAgICAgPEJ1YmJsZVxuICAgICAgICAgICAgICAgIGNsYXNzTmFtZT1cIndlYmNoYXRfX3N0YWNrZWQtbGF5b3V0X19tZXNzYWdlXCJcbiAgICAgICAgICAgICAgICBmcm9tVXNlcj17ZnJvbVVzZXJ9XG4gICAgICAgICAgICAgICAgbnViPXtzaG93TnViIHx8IChoYXNBdmF0YXIgfHwgaGFzTnViID8gJ2hpZGRlbicgOiBmYWxzZSl9XG4gICAgICAgICAgICAgID5cbiAgICAgICAgICAgICAgICB7cmVuZGVyQXR0YWNobWVudCh7XG4gICAgICAgICAgICAgICAgICBhY3Rpdml0eSxcbiAgICAgICAgICAgICAgICAgIGF0dGFjaG1lbnQ6IGlzTWVzc2FnZVxuICAgICAgICAgICAgICAgICAgICA/IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRlbnQ6IGFjdGl2aXR5RGlzcGxheVRleHQsXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogdGV4dEZvcm1hdFRvQ29udGVudFR5cGUoYWN0aXZpdHkudGV4dEZvcm1hdClcbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIDogdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgfSl9XG4gICAgICAgICAgICAgIDwvQnViYmxlPlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgKX1cbiAgICAgICAgICB7YXR0YWNobWVudHMubWFwKChhdHRhY2htZW50LCBpbmRleCkgPT4gKFxuICAgICAgICAgICAgPGRpdlxuICAgICAgICAgICAgICBhcmlhLXJvbGVkZXNjcmlwdGlvbj1cImF0dGFjaG1lbnRcIlxuICAgICAgICAgICAgICBjbGFzc05hbWU9e2NsYXNzTmFtZXMoJ3dlYmNoYXRfX3N0YWNrZWQtbGF5b3V0X19hdHRhY2htZW50LXJvdycsIHtcbiAgICAgICAgICAgICAgICAnd2ViY2hhdF9fc3RhY2tlZC1sYXlvdXRfX2F0dGFjaG1lbnQtcm93LS1maXJzdCc6ICFpbmRleFxuICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgLyogYXR0YWNobWVudHMgZG8gbm90IGhhdmUgYW4gSUQsIGl0IGlzIGFsd2F5cyBpbmRleGVkIGJ5IG51bWJlciAqL1xuICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3Qvbm8tYXJyYXktaW5kZXgta2V5ICovXG4gICAgICAgICAgICAgIGtleT17aW5kZXh9XG4gICAgICAgICAgICAgIHJvbGU9XCJncm91cFwiXG4gICAgICAgICAgICA+XG4gICAgICAgICAgICAgIDxTY3JlZW5SZWFkZXJUZXh0IHRleHQ9e2F0dGFjaGVkQWx0fSAvPlxuICAgICAgICAgICAgICA8QnViYmxlXG4gICAgICAgICAgICAgICAgY2xhc3NOYW1lPVwid2ViY2hhdF9fc3RhY2tlZC1sYXlvdXRfX2F0dGFjaG1lbnRcIlxuICAgICAgICAgICAgICAgIGZyb21Vc2VyPXtmcm9tVXNlcn1cbiAgICAgICAgICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcmVhY3Qvbm8tYXJyYXktaW5kZXgta2V5ICovXG4gICAgICAgICAgICAgICAga2V5PXtpbmRleH1cbiAgICAgICAgICAgICAgICBudWI9e2hhc0F2YXRhciB8fCBoYXNOdWIgPyAnaGlkZGVuJyA6IGZhbHNlfVxuICAgICAgICAgICAgICA+XG4gICAgICAgICAgICAgICAge3JlbmRlckF0dGFjaG1lbnQoeyBhY3Rpdml0eSwgYXR0YWNobWVudCB9KX1cbiAgICAgICAgICAgICAgPC9CdWJibGU+XG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICApKX1cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2ViY2hhdF9fc3RhY2tlZC1sYXlvdXRfX2FsaWdubWVudC1wYWRcIiAvPlxuICAgICAgPC9kaXY+XG4gICAgICB7dHlwZW9mIHJlbmRlckFjdGl2aXR5U3RhdHVzID09PSAnZnVuY3Rpb24nICYmIChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19zdGFja2VkLWxheW91dF9fc3RhdHVzXCI+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19zdGFja2VkLWxheW91dF9fYXZhdGFyLWd1dHRlclwiIC8+XG4gICAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19zdGFja2VkLWxheW91dF9fbnViLXBhZFwiIC8+XG4gICAgICAgICAge3JlbmRlckFjdGl2aXR5U3RhdHVzKHsgaGlkZVRpbWVzdGFtcCB9KX1cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cIndlYmNoYXRfX3N0YWNrZWQtbGF5b3V0X19hbGlnbm1lbnQtcGFkXCIgLz5cbiAgICAgICAgPC9kaXY+XG4gICAgICApfVxuICAgIDwvZGl2PlxuICApO1xufTtcblxuU3RhY2tlZExheW91dC5kZWZhdWx0UHJvcHMgPSB7XG4gIGhpZGVUaW1lc3RhbXA6IGZhbHNlLFxuICByZW5kZXJBY3Rpdml0eVN0YXR1czogKCkgPT4gZmFsc2UsXG4gIHJlbmRlckF2YXRhcjogdW5kZWZpbmVkLFxuICBzaG93Q2FsbG91dDogdHJ1ZVxufTtcblxuU3RhY2tlZExheW91dC5wcm9wVHlwZXMgPSB7XG4gIC8vIFByb3BUeXBlcyBjYW5ub3QgZnVsbHkgY2FwdHVyZSBUeXBlU2NyaXB0IHR5cGVzLlxuICAvLyBAdHMtaWdub3JlXG4gIGFjdGl2aXR5OiBQcm9wVHlwZXMuc2hhcGUoe1xuICAgIGF0dGFjaG1lbnRzOiBQcm9wVHlwZXMuYXJyYXksXG4gICAgY2hhbm5lbERhdGE6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgICBtZXNzYWdlQmFjazogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgICAgZGlzcGxheVRleHQ6IFByb3BUeXBlcy5zdHJpbmdcbiAgICAgIH0pXG4gICAgfSksXG4gICAgZnJvbTogUHJvcFR5cGVzLnNoYXBlKHtcbiAgICAgIHJvbGU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxuICAgIH0pLmlzUmVxdWlyZWQsXG4gICAgdGV4dDogUHJvcFR5cGVzLnN0cmluZyxcbiAgICB0ZXh0Rm9ybWF0OiBQcm9wVHlwZXMub25lT2YoWydtYXJrZG93bicsICdwbGFpbicsICd4bWwnXSksXG4gICAgdGltZXN0YW1wOiBQcm9wVHlwZXMuc3RyaW5nLFxuICAgIHR5cGU6IFByb3BUeXBlcy5zdHJpbmcuaXNSZXF1aXJlZFxuICB9KS5pc1JlcXVpcmVkLFxuICBoaWRlVGltZXN0YW1wOiBQcm9wVHlwZXMuYm9vbCxcblxuICAvLyBQcm9wVHlwZXMgY2Fubm90IHZhbGlkYXRlIHByZWNpc2VseSB3aXRoIGl0cyBUeXBlU2NyaXB0IGNvdW50ZXJwYXJ0LlxuICAvLyBAdHMtaWdub3JlXG4gIHJlbmRlckFjdGl2aXR5U3RhdHVzOiBQcm9wVHlwZXMub25lT2ZUeXBlKFtQcm9wVHlwZXMub25lT2YoW2ZhbHNlXSksIFByb3BUeXBlcy5mdW5jXSksXG4gIHJlbmRlckF0dGFjaG1lbnQ6IFByb3BUeXBlcy5mdW5jLmlzUmVxdWlyZWQsXG5cbiAgLy8gUHJvcFR5cGVzIGNhbm5vdCB2YWxpZGF0ZSBwcmVjaXNlbHkgd2l0aCBpdHMgVHlwZVNjcmlwdCBjb3VudGVycGFydC5cbiAgLy8gQHRzLWlnbm9yZVxuICByZW5kZXJBdmF0YXI6IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5vbmVPZihbZmFsc2VdKSwgUHJvcFR5cGVzLmZ1bmNdKSxcbiAgc2hvd0NhbGxvdXQ6IFByb3BUeXBlcy5ib29sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBTdGFja2VkTGF5b3V0O1xuXG5leHBvcnQgeyBjb25uZWN0U3RhY2tlZExheW91dCB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7Ozs7Ozs7Ozs7Ozs7QUFNQSxJQUFRQSxlQUFSLEdBQTZFQyw2QkFBN0UsQ0FBUUQsZUFBUjtBQUFBLElBQXlCRSxnQkFBekIsR0FBNkVELDZCQUE3RSxDQUF5QkMsZ0JBQXpCO0FBQUEsSUFBMkNDLFlBQTNDLEdBQTZFRiw2QkFBN0UsQ0FBMkNFLFlBQTNDO0FBQUEsSUFBeURDLGVBQXpELEdBQTZFSCw2QkFBN0UsQ0FBeURHLGVBQXpEO0FBRUEsSUFBTUMsVUFBVSxHQUFHO0VBQ2pCLDZCQUE2QjtJQUMzQkMsUUFBUSxFQUFFLFVBRGlCO0lBQ0w7SUFFdEIsNkpBQ0U7TUFDRUMsT0FBTyxFQUFFO0lBRFgsQ0FKeUI7SUFRM0IsNkNBQTZDO01BQzNDQyxVQUFVLEVBQUU7SUFEK0IsQ0FSbEI7SUFZM0IsMENBQTBDO01BQ3hDQyxLQUFLLEVBQUU7SUFEaUMsQ0FaZjtJQWdCM0IsNkNBQTZDO01BQzNDRixPQUFPLEVBQUUsTUFEa0M7TUFFM0NHLGFBQWEsRUFBRSxRQUY0QjtNQUczQ0YsVUFBVSxFQUFFO0lBSCtCLENBaEJsQjtJQXNCM0Isd0NBQXdDO01BQ3RDLDZKQUNFO1FBQ0VFLGFBQWEsRUFBRTtNQURqQjtJQUZvQyxDQXRCYjtJQTZCM0IsdUNBQXVDO01BQ3JDQyxJQUFJ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