"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (obj) { return typeof obj; } : function (obj) { return obj && "function" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }, _typeof(obj); }

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _botframeworkWebchatApi = require("botframework-webchat-api");

var _classnames = _interopRequireDefault(require("classnames"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var _react = _interopRequireWildcard(require("react"));

var _isPresentational = _interopRequireDefault(require("./LiveRegion/isPresentational"));

var _LiveRegionActivity = _interopRequireDefault(require("../LiveRegion/LiveRegionActivity"));

var _SendFailed = _interopRequireDefault(require("./LiveRegion/SendFailed"));

var _LiveRegionTwinComposer = _interopRequireDefault(require("../providers/LiveRegionTwin/LiveRegionTwinComposer"));

var _tabbableElements = _interopRequireDefault(require("../Utils/tabbableElements"));

var _useLocalizeAccessKey = _interopRequireDefault(require("../hooks/internal/useLocalizeAccessKey"));

var _useQueueStaticElement = _interopRequireDefault(require("../providers/LiveRegionTwin/useQueueStaticElement"));

var _useStyleToEmotionObject = _interopRequireDefault(require("../hooks/internal/useStyleToEmotionObject"));

var _useSuggestedActionsAccessKey = _interopRequireDefault(require("../hooks/internal/useSuggestedActionsAccessKey"));

var _useTypistNames3 = _interopRequireDefault(require("./useTypistNames"));

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _createForOfIteratorHelper(o, allowArrayLike) { var it = typeof Symbol !== "undefined" && o[Symbol.iterator] || o["@@iterator"]; if (!it) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e2) { throw _e2; }, f: F }; } throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = it.call(o); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e3) { didErr = true; err = _e3; }, f: function f() { try { if (!normalCompletion && it.return != null) it.return(); } finally { if (didErr) throw err; } } }; }

function _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }

function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }

function _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === "string") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === "Object" && o.constructor) n = o.constructor.name; if (n === "Map" || n === "Set") return Array.from(o); if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }

function _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }

function _iterableToArrayLimit(arr, i) { var _i = arr == null ? null : typeof Symbol !== "undefined" && arr[Symbol.iterator] || arr["@@iterator"]; if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i["return"] != null) _i["return"](); } finally { if (_d) throw _e; } } return _arr; }

function _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }

var useActivities = _botframeworkWebchatApi.hooks.useActivities,
    useGetKeyByActivity = _botframeworkWebchatApi.hooks.useGetKeyByActivity,
    useLocalizer = _botframeworkWebchatApi.hooks.useLocalizer,
    useStyleOptions = _botframeworkWebchatApi.hooks.useStyleOptions;
var ROOT_STYLE = {
  '&.webchat__live-region-transcript': {
    '& .webchat__live-region-transcript__note, & .webchat__live-region-transcript__note, & .webchat__live-region-transcript__text-element': {
      color: 'transparent',
      height: 1,
      overflow: 'hidden',
      position: 'absolute',
      top: 0,
      whiteSpace: 'nowrap',
      width: 1
    }
  }
};

var LiveRegionTranscriptCore = function LiveRegionTranscriptCore(_ref) {
  var activityElementMapRef = _ref.activityElementMapRef;

  // We are looking for all activities instead of just those will be rendered.
  // This is because some activities that chosen not be rendered in the chat history,
  // we might still need to be read by screen reader. Such as, suggested actions without text content.
  var _useSuggestedActionsA = (0, _useSuggestedActionsAccessKey.default)(),
      _useSuggestedActionsA2 = _slicedToArray(_useSuggestedActionsA, 1),
      accessKey = _useSuggestedActionsA2[0];

  var _useActivities = useActivities(),
      _useActivities2 = _slicedToArray(_useActivities, 1),
      activities = _useActivities2[0];

  var _useTypistNames = (0, _useTypistNames3.default)(),
      _useTypistNames2 = _slicedToArray(_useTypistNames, 1),
      typistNames = _useTypistNames2[0];

  var getKeyByActivity = useGetKeyByActivity();
  var localize = useLocalizer();
  var localizeAccessKeyAsAccessibleName = (0, _useLocalizeAccessKey.default)('accessible name');
  var queueStaticElement = (0, _useQueueStaticElement.default)();
  var liveRegionInteractiveLabelAlt = localize('TRANSCRIPT_LIVE_REGION_INTERACTIVE_LABEL_ALT');
  var liveRegionInteractiveWithLinkLabelAlt = localize('TRANSCRIPT_LIVE_REGION_INTERACTIVE_WITH_LINKS_LABEL_ALT');
  var typingIndicator = !!typistNames.length && localize(typistNames.length > 1 ? 'TYPING_INDICATOR_MULTIPLE_TEXT' : 'TYPING_INDICATOR_SINGLE_TEXT', typistNames[0]);
  var liveRegionSuggestedActionsLabelAlt = accessKey ? localize('TRANSCRIPT_LIVE_REGION_SUGGESTED_ACTIONS_WITH_ACCESS_KEY_LABEL_ALT', localizeAccessKeyAsAccessibleName(accessKey)) : localize('TRANSCRIPT_LIVE_REGION_SUGGESTED_ACTIONS_LABEL_ALT');
  var keyedActivities = (0, _react.useMemo)(function () {
    return Object.freeze(activities.reduce(function (intermediate, activity) {
      // Only "message" activity will be read by screen reader.
      if (activity.type === 'message') {
        return intermediate.set(getKeyByActivity(activity), activity);
      }

      return intermediate;
    }, new Map()));
  }, [activities, getKeyByActivity]);
  var prevRenderingActivitiesRef = (0, _react.useRef)();
  (0, _react.useEffect)(function () {
    var prevRenderingActivities = prevRenderingActivitiesRef.current;
    var appendedActivities = []; // Bottom-up, find activities which are recently appended (i.e. new activity will have a new key).
    // We only consider new activities added to the bottom of the chat history.
    // Based on how `aria-relevant="additions"` works, activities that are updated, deleted, or reordered, should be ignored.

    var _iterator = _createForOfIteratorHelper(Array.from(keyedActivities.entries()).reverse()),
        _step;

    try {
      for (_iterator.s(); !(_step = _iterator.n()).done;) {
        var _step$value = _slicedToArray(_step.value, 2),
            key = _step$value[0],
            activity = _step$value[1];

        if (prevRenderingActivities !== null && prevRenderingActivities !== void 0 && prevRenderingActivities.has(key)) {
          break;
        }

        appendedActivities.unshift({
          activity: activity,
          key: key
        });
        (0, _isPresentational.default)(activity) || queueStaticElement( /*#__PURE__*/_react.default.createElement(_LiveRegionActivity.default, {
          activity: activity
        }));
      }
    } catch (err) {
      _iterator.e(err);
    } finally {
      _iterator.f();
    }

    var hasNewLink = appendedActivities.some(function (_ref2) {
      var _activityElementMapRe;

      var key = _ref2.key;
      return (_activityElementMapRe = activityElementMapRef.current.get(key)) === null || _activityElementMapRe === void 0 ? void 0 : _activityElementMapRe.querySelector('a');
    });
    var hasNewWidget = appendedActivities.some(function (_ref3) {
      var _activityElementMapRe2;

      var key = _ref3.key;
      return !!(0, _tabbableElements.default)((_activityElementMapRe2 = activityElementMapRef.current.get(key)) === null || _activityElementMapRe2 === void 0 ? void 0 : _activityElementMapRe2.querySelector('.webchat__basic-transcript__activity-body')).length;
    });
    var hasSuggestedActions = appendedActivities.some(function (_ref4) {
      var _activity$suggestedAc, _activity$suggestedAc2;

      var activity = _ref4.activity;
      return activity.type === 'message' && ((_activity$suggestedAc = activity.suggestedActions) === null || _activity$suggestedAc === void 0 ? void 0 : (_activity$suggestedAc2 = _activity$suggestedAc.actions) === null || _activity$suggestedAc2 === void 0 ? void 0 : _activity$suggestedAc2.length);
    }); // This is a footnote reading either:
    // - "Message is interactive. Press shift tab key 2 to 3 times to switch to the chat history. Then click on the message to interact.", or;
    // - "One or more links in the message. Press shift tab key 2 to 3 times to switch to the chat history. Then click on the message to interact."

    if (hasNewLink || hasNewWidget) {
      queueStaticElement( /*#__PURE__*/_react.default.createElement("div", {
        className: "webchat__live-region-transcript__note",
        role: "note"
      }, hasNewLink ? liveRegionInteractiveWithLinkLabelAlt : liveRegionInteractiveLabelAlt));
    } // This is a footnote reading "Suggested actions container: has content. Press CTRL + SHIFT + A to select."


    if (hasSuggestedActions) {
      queueStaticElement( /*#__PURE__*/_react.default.createElement("div", {
        className: "webchat__live-region-transcript__note",
        role: "note"
      }, liveRegionSuggestedActionsLabelAlt));
    }

    prevRenderingActivitiesRef.current = keyedActivities;
  }, [activityElementMapRef, liveRegionInteractiveLabelAlt, liveRegionInteractiveWithLinkLabelAlt, liveRegionSuggestedActionsLabelAlt, prevRenderingActivitiesRef, queueStaticElement, keyedActivities]);
  (0, _react.useEffect)(function () {
    typingIndicator && queueStaticElement(typingIndicator);
  }, [queueStaticElement, typingIndicator]);
  return /*#__PURE__*/_react.default.createElement(_SendFailed.default, null);
};

var LiveRegionTranscript = function LiveRegionTranscript(_ref5) {
  var activityElementMapRef = _ref5.activityElementMapRef;

  var _useStyleOptions = useStyleOptions(),
      _useStyleOptions2 = _slicedToArray(_useStyleOptions, 1),
      internalLiveRegionFadeAfter = _useStyleOptions2[0].internalLiveRegionFadeAfter;

  var localize = useLocalizer();
  var rootClassName = (0, _useStyleToEmotionObject.default)()(ROOT_STYLE) + '';
  var transcriptRoleDescription = localize('TRANSCRIPT_ARIA_ROLE_ALT');
  return /*#__PURE__*/_react.default.createElement(_LiveRegionTwinComposer.default, {
    "aria-roledescription": transcriptRoleDescription,
    className: (0, _classnames.default)('webchat__live-region-transcript', rootClassName),
    fadeAfter: internalLiveRegionFadeAfter,
    role: "log",
    textElementClassName: "webchat__live-region-transcript__text-element"
  }, /*#__PURE__*/_react.default.createElement(LiveRegionTranscriptCore, {
    activityElementMapRef: activityElementMapRef
  }));
};

LiveRegionTranscript.propTypes = {
  // PropTypes cannot be fully expressed in TypeScript.
  // @ts-ignore
  activityElementMapRef: _propTypes.default.shape({
    current: _propTypes.default.instanceOf(Map)
  }).isRequired
};
var _default = LiveRegionTranscript;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJ1c2VBY3Rpdml0aWVzIiwiaG9va3MiLCJ1c2VHZXRLZXlCeUFjdGl2aXR5IiwidXNlTG9jYWxpemVyIiwidXNlU3R5bGVPcHRpb25zIiwiUk9PVF9TVFlMRSIsImNvbG9yIiwiaGVpZ2h0Iiwib3ZlcmZsb3ciLCJwb3NpdGlvbiIsInRvcCIsIndoaXRlU3BhY2UiLCJ3aWR0aCIsIkxpdmVSZWdpb25UcmFuc2NyaXB0Q29yZSIsImFjdGl2aXR5RWxlbWVudE1hcFJlZiIsInVzZVN1Z2dlc3RlZEFjdGlvbnNBY2Nlc3NLZXkiLCJhY2Nlc3NLZXkiLCJhY3Rpdml0aWVzIiwidXNlVHlwaXN0TmFtZXMiLCJ0eXBpc3ROYW1lcyIsImdldEtleUJ5QWN0aXZpdHkiLCJsb2NhbGl6ZSIsImxvY2FsaXplQWNjZXNzS2V5QXNBY2Nlc3NpYmxlTmFtZSIsInVzZUxvY2FsaXplQWNjZXNzS2V5IiwicXVldWVTdGF0aWNFbGVtZW50IiwidXNlUXVldWVTdGF0aWNFbGVtZW50IiwibGl2ZVJlZ2lvbkludGVyYWN0aXZlTGFiZWxBbHQiLCJsaXZlUmVnaW9uSW50ZXJhY3RpdmVXaXRoTGlua0xhYmVsQWx0IiwidHlwaW5nSW5kaWNhdG9yIiwibGVuZ3RoIiwibGl2ZVJlZ2lvblN1Z2dlc3RlZEFjdGlvbnNMYWJlbEFsdCIsImtleWVkQWN0aXZpdGllcyIsInVzZU1lbW8iLCJPYmplY3QiLCJmcmVlemUiLCJyZWR1Y2UiLCJpbnRlcm1lZGlhdGUiLCJhY3Rpdml0eSIsInR5cGUiLCJzZXQiLCJNYXAiLCJwcmV2UmVuZGVyaW5nQWN0aXZpdGllc1JlZiIsInVzZVJlZiIsInVzZUVmZmVjdCIsInByZXZSZW5kZXJpbmdBY3Rpdml0aWVzIiwiY3VycmVudCIsImFwcGVuZGVkQWN0aXZpdGllcyIsIkFycmF5IiwiZnJvbSIsImVudHJpZXMiLCJyZXZlcnNlIiwia2V5IiwiaGFzIiwidW5zaGlmdCIsImlzUHJlc2VudGF0aW9uYWwiLCJoYXNOZXdMaW5rIiwic29tZSIsImdldCIsInF1ZXJ5U2VsZWN0b3IiLCJoYXNOZXdXaWRnZXQiLCJ0YWJiYWJsZUVsZW1lbnRzIiwiaGFzU3VnZ2VzdGVkQWN0aW9ucyIsInN1Z2dlc3RlZEFjdGlvbnMiLCJhY3Rpb25zIiwiTGl2ZVJlZ2lvblRyYW5zY3JpcHQiLCJpbnRlcm5hbExpdmVSZWdpb25GYWRlQWZ0ZXIiLCJyb290Q2xhc3NOYW1lIiwidXNlU3R5bGVUb0Vtb3Rpb25PYmplY3QiLCJ0cmFuc2NyaXB0Um9sZURlc2NyaXB0aW9uIiwiY2xhc3NOYW1lcyIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsInNoYXBlIiwiaW5zdGFuY2VPZiIsImlzUmVxdWlyZWQiXSwic291cmNlUm9vdCI6ImNvbXBvbmVudDovLy8iLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9UcmFuc2NyaXB0L0xpdmVSZWdpb25UcmFuc2NyaXB0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBob29rcyB9IGZyb20gJ2JvdGZyYW1ld29yay13ZWJjaGF0LWFwaSc7XG5pbXBvcnQgY2xhc3NOYW1lcyBmcm9tICdjbGFzc25hbWVzJztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VNZW1vLCB1c2VSZWYgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgdHlwZSB7IEZDLCBSZWZPYmplY3QsIFZGQyB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCB0eXBlIHsgV2ViQ2hhdEFjdGl2aXR5IH0gZnJvbSAnYm90ZnJhbWV3b3JrLXdlYmNoYXQtY29yZSc7XG5cbmltcG9ydCBpc1ByZXNlbnRhdGlvbmFsIGZyb20gJy4vTGl2ZVJlZ2lvbi9pc1ByZXNlbnRhdGlvbmFsJztcbmltcG9ydCBMaXZlUmVnaW9uQWN0aXZpdHkgZnJvbSAnLi4vTGl2ZVJlZ2lvbi9MaXZlUmVnaW9uQWN0aXZpdHknO1xuaW1wb3J0IExpdmVSZWdpb25TZW5kRmFpbGVkIGZyb20gJy4vTGl2ZVJlZ2lvbi9TZW5kRmFpbGVkJztcbmltcG9ydCBMaXZlUmVnaW9uVHdpbkNvbXBvc2VyIGZyb20gJy4uL3Byb3ZpZGVycy9MaXZlUmVnaW9uVHdpbi9MaXZlUmVnaW9uVHdpbkNvbXBvc2VyJztcbmltcG9ydCB0YWJiYWJsZUVsZW1lbnRzIGZyb20gJy4uL1V0aWxzL3RhYmJhYmxlRWxlbWVudHMnO1xuaW1wb3J0IHVzZUxvY2FsaXplQWNjZXNzS2V5IGZyb20gJy4uL2hvb2tzL2ludGVybmFsL3VzZUxvY2FsaXplQWNjZXNzS2V5JztcbmltcG9ydCB1c2VRdWV1ZVN0YXRpY0VsZW1lbnQgZnJvbSAnLi4vcHJvdmlkZXJzL0xpdmVSZWdpb25Ud2luL3VzZVF1ZXVlU3RhdGljRWxlbWVudCc7XG5pbXBvcnQgdXNlU3R5bGVUb0Vtb3Rpb25PYmplY3QgZnJvbSAnLi4vaG9va3MvaW50ZXJuYWwvdXNlU3R5bGVUb0Vtb3Rpb25PYmplY3QnO1xuaW1wb3J0IHVzZVN1Z2dlc3RlZEFjdGlvbnNBY2Nlc3NLZXkgZnJvbSAnLi4vaG9va3MvaW50ZXJuYWwvdXNlU3VnZ2VzdGVkQWN0aW9uc0FjY2Vzc0tleSc7XG5pbXBvcnQgdXNlVHlwaXN0TmFtZXMgZnJvbSAnLi91c2VUeXBpc3ROYW1lcyc7XG5cbmltcG9ydCB0eXBlIHsgQWN0aXZpdHlFbGVtZW50TWFwIH0gZnJvbSAnLi90eXBlcyc7XG5cbmNvbnN0IHsgdXNlQWN0aXZpdGllcywgdXNlR2V0S2V5QnlBY3Rpdml0eSwgdXNlTG9jYWxpemVyLCB1c2VTdHlsZU9wdGlvbnMgfSA9IGhvb2tzO1xuXG5jb25zdCBST09UX1NUWUxFID0ge1xuICAnJi53ZWJjaGF0X19saXZlLXJlZ2lvbi10cmFuc2NyaXB0Jzoge1xuICAgICcmIC53ZWJjaGF0X19saXZlLXJlZ2lvbi10cmFuc2NyaXB0X19ub3RlLCAmIC53ZWJjaGF0X19saXZlLXJlZ2lvbi10cmFuc2NyaXB0X19ub3RlLCAmIC53ZWJjaGF0X19saXZlLXJlZ2lvbi10cmFuc2NyaXB0X190ZXh0LWVsZW1lbnQnOlxuICAgICAge1xuICAgICAgICBjb2xvcjogJ3RyYW5zcGFyZW50JyxcbiAgICAgICAgaGVpZ2h0OiAxLFxuICAgICAgICBvdmVyZmxvdzogJ2hpZGRlbicsXG4gICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICB0b3A6IDAsXG4gICAgICAgIHdoaXRlU3BhY2U6ICdub3dyYXAnLFxuICAgICAgICB3aWR0aDogMVxuICAgICAgfVxuICB9XG59O1xuXG50eXBlIFJlbmRlcmluZ0FjdGl2aXRpZXMgPSBNYXA8c3RyaW5nLCBXZWJDaGF0QWN0aXZpdHk+O1xuXG50eXBlIExpdmVSZWdpb25UcmFuc2NyaXB0Q29yZVByb3BzID0ge1xuICBhY3Rpdml0eUVsZW1lbnRNYXBSZWY6IFJlZk9iamVjdDxBY3Rpdml0eUVsZW1lbnRNYXA+O1xufTtcblxuY29uc3QgTGl2ZVJlZ2lvblRyYW5zY3JpcHRDb3JlOiBGQzxMaXZlUmVnaW9uVHJhbnNjcmlwdENvcmVQcm9wcz4gPSAoeyBhY3Rpdml0eUVsZW1lbnRNYXBSZWYgfSkgPT4ge1xuICAvLyBXZSBhcmUgbG9va2luZyBmb3IgYWxsIGFjdGl2aXRpZXMgaW5zdGVhZCBvZiBqdXN0IHRob3NlIHdpbGwgYmUgcmVuZGVyZWQuXG4gIC8vIFRoaXMgaXMgYmVjYXVzZSBzb21lIGFjdGl2aXRpZXMgdGhhdCBjaG9zZW4gbm90IGJlIHJlbmRlcmVkIGluIHRoZSBjaGF0IGhpc3RvcnksXG4gIC8vIHdlIG1pZ2h0IHN0aWxsIG5lZWQgdG8gYmUgcmVhZCBieSBzY3JlZW4gcmVhZGVyLiBTdWNoIGFzLCBzdWdnZXN0ZWQgYWN0aW9ucyB3aXRob3V0IHRleHQgY29udGVudC5cbiAgY29uc3QgW2FjY2Vzc0tleV0gPSB1c2VTdWdnZXN0ZWRBY3Rpb25zQWNjZXNzS2V5KCk7XG4gIGNvbnN0IFthY3Rpdml0aWVzXSA9IHVzZUFjdGl2aXRpZXMoKTtcbiAgY29uc3QgW3R5cGlzdE5hbWVzXSA9IHVzZVR5cGlzdE5hbWVzKCk7XG4gIGNvbnN0IGdldEtleUJ5QWN0aXZpdHkgPSB1c2VHZXRLZXlCeUFjdGl2aXR5KCk7XG4gIGNvbnN0IGxvY2FsaXplID0gdXNlTG9jYWxpemVyKCk7XG4gIGNvbnN0IGxvY2FsaXplQWNjZXNzS2V5QXNBY2Nlc3NpYmxlTmFtZSA9IHVzZUxvY2FsaXplQWNjZXNzS2V5KCdhY2Nlc3NpYmxlIG5hbWUnKTtcbiAgY29uc3QgcXVldWVTdGF0aWNFbGVtZW50ID0gdXNlUXVldWVTdGF0aWNFbGVtZW50KCk7XG5cbiAgY29uc3QgbGl2ZVJlZ2lvbkludGVyYWN0aXZlTGFiZWxBbHQgPSBsb2NhbGl6ZSgnVFJBTlNDUklQVF9MSVZFX1JFR0lPTl9JTlRFUkFDVElWRV9MQUJFTF9BTFQnKTtcbiAgY29uc3QgbGl2ZVJlZ2lvbkludGVyYWN0aXZlV2l0aExpbmtMYWJlbEFsdCA9IGxvY2FsaXplKCdUUkFOU0NSSVBUX0xJVkVfUkVHSU9OX0lOVEVSQUNUSVZFX1dJVEhfTElOS1NfTEFCRUxfQUxUJyk7XG4gIGNvbnN0IHR5cGluZ0luZGljYXRvciA9XG4gICAgISF0eXBpc3ROYW1lcy5sZW5ndGggJiZcbiAgICBsb2NhbGl6ZShcbiAgICAgIHR5cGlzdE5hbWVzLmxlbmd0aCA+IDEgPyAnVFlQSU5HX0lORElDQVRPUl9NVUxUSVBMRV9URVhUJyA6ICdUWVBJTkdfSU5ESUNBVE9SX1NJTkdMRV9URVhUJyxcbiAgICAgIHR5cGlzdE5hbWVzWzBdXG4gICAgKTtcblxuICBjb25zdCBsaXZlUmVnaW9uU3VnZ2VzdGVkQWN0aW9uc0xhYmVsQWx0ID0gYWNjZXNzS2V5XG4gICAgPyBsb2NhbGl6ZShcbiAgICAgICAgJ1RSQU5TQ1JJUFRfTElWRV9SRUdJT05fU1VHR0VTVEVEX0FDVElPTlNfV0lUSF9BQ0NFU1NfS0VZX0xBQkVMX0FMVCcsXG4gICAgICAgIGxvY2FsaXplQWNjZXNzS2V5QXNBY2Nlc3NpYmxlTmFtZShhY2Nlc3NLZXkpXG4gICAgICApXG4gICAgOiBsb2NhbGl6ZSgnVFJBTlNDUklQVF9MSVZFX1JFR0lPTl9TVUdHRVNURURfQUNUSU9OU19MQUJFTF9BTFQnKTtcblxuICBjb25zdCBrZXllZEFjdGl2aXRpZXMgPSB1c2VNZW1vPFJlYWRvbmx5PFJlbmRlcmluZ0FjdGl2aXRpZXM+PihcbiAgICAoKSA9PlxuICAgICAgT2JqZWN0LmZyZWV6ZShcbiAgICAgICAgYWN0aXZpdGllcy5yZWR1Y2U8UmVuZGVyaW5nQWN0aXZpdGllcz4oKGludGVybWVkaWF0ZSwgYWN0aXZpdHkpID0+IHtcbiAgICAgICAgICAvLyBPbmx5IFwibWVzc2FnZVwiIGFjdGl2aXR5IHdpbGwgYmUgcmVhZCBieSBzY3JlZW4gcmVhZGVyLlxuICAgICAgICAgIGlmIChhY3Rpdml0eS50eXBlID09PSAnbWVzc2FnZScpIHtcbiAgICAgICAgICAgIHJldHVybiBpbnRlcm1lZGlhdGUuc2V0KGdldEtleUJ5QWN0aXZpdHkoYWN0aXZpdHkpLCBhY3Rpdml0eSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgcmV0dXJuIGludGVybWVkaWF0ZTtcbiAgICAgICAgfSwgbmV3IE1hcDxzdHJpbmcsIFdlYkNoYXRBY3Rpdml0eT4oKSlcbiAgICAgICksXG4gICAgW2FjdGl2aXRpZXMsIGdldEtleUJ5QWN0aXZpdHldXG4gICk7XG5cbiAgY29uc3QgcHJldlJlbmRlcmluZ0FjdGl2aXRpZXNSZWYgPSB1c2VSZWY8UmVhZG9ubHk8UmVuZGVyaW5nQWN0aXZpdGllcz4+KCk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCB7IGN1cnJlbnQ6IHByZXZSZW5kZXJpbmdBY3Rpdml0aWVzIH0gPSBwcmV2UmVuZGVyaW5nQWN0aXZpdGllc1JlZjtcbiAgICBjb25zdCBhcHBlbmRlZEFjdGl2aXRpZXM6IHsgYWN0aXZpdHk6IFdlYkNoYXRBY3Rpdml0eTsga2V5OiBzdHJpbmcgfVtdID0gW107XG5cbiAgICAvLyBCb3R0b20tdXAsIGZpbmQgYWN0aXZpdGllcyB3aGljaCBhcmUgcmVjZW50bHkgYXBwZW5kZWQgKGkuZS4gbmV3IGFjdGl2aXR5IHdpbGwgaGF2ZSBhIG5ldyBrZXkpLlxuICAgIC8vIFdlIG9ubHkgY29uc2lkZXIgbmV3IGFjdGl2aXRpZXMgYWRkZWQgdG8gdGhlIGJvdHRvbSBvZiB0aGUgY2hhdCBoaXN0b3J5LlxuICAgIC8vIEJhc2VkIG9uIGhvdyBgYXJpYS1yZWxldmFudD1cImFkZGl0aW9uc1wiYCB3b3JrcywgYWN0aXZpdGllcyB0aGF0IGFyZSB1cGRhdGVkLCBkZWxldGVkLCBvciByZW9yZGVyZWQsIHNob3VsZCBiZSBpZ25vcmVkLlxuICAgIGZvciAoY29uc3QgW2tleSwgYWN0aXZpdHldIG9mIEFycmF5LmZyb20oa2V5ZWRBY3Rpdml0aWVzLmVudHJpZXMoKSkucmV2ZXJzZSgpKSB7XG4gICAgICBpZiAocHJldlJlbmRlcmluZ0FjdGl2aXRpZXM/LmhhcyhrZXkpKSB7XG4gICAgICAgIGJyZWFrO1xuICAgICAgfVxuXG4gICAgICBhcHBlbmRlZEFjdGl2aXRpZXMudW5zaGlmdCh7IGFjdGl2aXR5LCBrZXkgfSk7XG5cbiAgICAgIGlzUHJlc2VudGF0aW9uYWwoYWN0aXZpdHkpIHx8IHF1ZXVlU3RhdGljRWxlbWVudCg8TGl2ZVJlZ2lvbkFjdGl2aXR5IGFjdGl2aXR5PXthY3Rpdml0eX0gLz4pO1xuICAgIH1cblxuICAgIGNvbnN0IGhhc05ld0xpbmsgPSBhcHBlbmRlZEFjdGl2aXRpZXMuc29tZSgoeyBrZXkgfSkgPT4gYWN0aXZpdHlFbGVtZW50TWFwUmVmLmN1cnJlbnQuZ2V0KGtleSk/LnF1ZXJ5U2VsZWN0b3IoJ2EnKSk7XG5cbiAgICBjb25zdCBoYXNOZXdXaWRnZXQgPSBhcHBlbmRlZEFjdGl2aXRpZXMuc29tZShcbiAgICAgICh7IGtleSB9KSA9PlxuICAgICAgICAhIXRhYmJhYmxlRWxlbWVudHMoXG4gICAgICAgICAgYWN0aXZpdHlFbGVtZW50TWFwUmVmLmN1cnJlbnQuZ2V0KGtleSk/LnF1ZXJ5U2VsZWN0b3IoJy53ZWJjaGF0X19iYXNpYy10cmFuc2NyaXB0X19hY3Rpdml0eS1ib2R5JylcbiAgICAgICAgKS5sZW5ndGhcbiAgICApO1xuXG4gICAgY29uc3QgaGFzU3VnZ2VzdGVkQWN0aW9ucyA9IGFwcGVuZGVkQWN0aXZpdGllcy5zb21lKFxuICAgICAgKHsgYWN0aXZpdHkgfSkgPT4gYWN0aXZpdHkudHlwZSA9PT0gJ21lc3NhZ2UnICYmIGFjdGl2aXR5LnN1Z2dlc3RlZEFjdGlvbnM/LmFjdGlvbnM/Lmxlbmd0aFxuICAgICk7XG5cbiAgICAvLyBUaGlzIGlzIGEgZm9vdG5vdGUgcmVhZGluZyBlaXRoZXI6XG4gICAgLy8gLSBcIk1lc3NhZ2UgaXMgaW50ZXJhY3RpdmUuIFByZXNzIHNoaWZ0IHRhYiBrZXkgMiB0byAzIHRpbWVzIHRvIHN3aXRjaCB0byB0aGUgY2hhdCBoaXN0b3J5LiBUaGVuIGNsaWNrIG9uIHRoZSBtZXNzYWdlIHRvIGludGVyYWN0LlwiLCBvcjtcbiAgICAvLyAtIFwiT25lIG9yIG1vcmUgbGlua3MgaW4gdGhlIG1lc3NhZ2UuIFByZXNzIHNoaWZ0IHRhYiBrZXkgMiB0byAzIHRpbWVzIHRvIHN3aXRjaCB0byB0aGUgY2hhdCBoaXN0b3J5LiBUaGVuIGNsaWNrIG9uIHRoZSBtZXNzYWdlIHRvIGludGVyYWN0LlwiXG4gICAgaWYgKGhhc05ld0xpbmsgfHwgaGFzTmV3V2lkZ2V0KSB7XG4gICAgICBxdWV1ZVN0YXRpY0VsZW1lbnQoXG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwid2ViY2hhdF9fbGl2ZS1yZWdpb24tdHJhbnNjcmlwdF9fbm90ZVwiIHJvbGU9XCJub3RlXCI+XG4gICAgICAgICAge2hhc05ld0xpbmsgPyBsaXZlUmVnaW9uSW50ZXJhY3RpdmVXaXRoTGlua0xhYmVsQWx0IDogbGl2ZVJlZ2lvbkludGVyYWN0aXZlTGFiZWxBbHR9XG4gICAgICAgIDwvZGl2PlxuICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBUaGlzIGlzIGEgZm9vdG5vdGUgcmVhZGluZyBcIlN1Z2dlc3RlZCBhY3Rpb25zIGNvbnRhaW5lcjogaGFzIGNvbnRlbnQuIFByZXNzIENUUkwgKyBTSElGVCArIEEgdG8gc2VsZWN0LlwiXG4gICAgaWYgKGhhc1N1Z2dlc3RlZEFjdGlvbnMpIHtcbiAgICAgIHF1ZXVlU3RhdGljRWxlbWVudChcbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJ3ZWJjaGF0X19saXZlLXJlZ2lvbi10cmFuc2NyaXB0X19ub3RlXCIgcm9sZT1cIm5vdGVcIj5cbiAgICAgICAgICB7bGl2ZVJlZ2lvblN1Z2dlc3RlZEFjdGlvbnNMYWJlbEFsdH1cbiAgICAgICAgPC9kaXY+XG4gICAgICApO1xuICAgIH1cblxuICAgIHByZXZSZW5kZXJpbmdBY3Rpdml0aWVzUmVmLmN1cnJlbnQgPSBrZXllZEFjdGl2aXRpZXM7XG4gIH0sIFtcbiAgICBhY3Rpdml0eUVsZW1lbnRNYXBSZWYsXG4gICAgbGl2ZVJlZ2lvbkludGVyYWN0aXZlTGFiZWxBbHQsXG4gICAgbGl2ZVJlZ2lvbkludGVyYWN0aXZlV2l0aExpbmtMYWJlbEFsdCxcbiAgICBsaXZlUmVnaW9uU3VnZ2VzdGVkQWN0aW9uc0xhYmVsQWx0LFxuICAgIHByZXZSZW5kZXJpbmdBY3Rpdml0aWVzUmVmLFxuICAgIHF1ZXVlU3RhdGljRWxlbWVudCxcbiAgICBrZXllZEFjdGl2aXRpZXNcbiAgXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICB0eXBpbmdJbmRpY2F0b3IgJiYgcXVldWVTdGF0aWNFbGVtZW50KHR5cGluZ0luZGljYXRvcik7XG4gIH0sIFtxdWV1ZVN0YXRpY0VsZW1lbnQsIHR5cGluZ0luZGljYXRvcl0pO1xuXG4gIHJldHVybiA8TGl2ZVJlZ2lvblNlbmRGYWlsZWQgLz47XG59O1xuXG50eXBlIExpdmVSZWdpb25UcmFuc2NyaXB0UHJvcHMgPSB7XG4gIGFjdGl2aXR5RWxlbWVudE1hcFJlZjogUmVmT2JqZWN0PEFjdGl2aXR5RWxlbWVudE1hcD47XG59O1xuXG5jb25zdCBMaXZlUmVnaW9uVHJhbnNjcmlwdDogVkZDPExpdmVSZWdpb25UcmFuc2NyaXB0UHJvcHM+ID0gKHsgYWN0aXZpdHlFbGVtZW50TWFwUmVmIH0pID0+IHtcbiAgY29uc3QgW3sgaW50ZXJuYWxMaXZlUmVnaW9uRmFkZUFmdGVyIH1dID0gdXNlU3R5bGVPcHRpb25zKCk7XG4gIGNvbnN0IGxvY2FsaXplID0gdXNlTG9jYWxpemVyKCk7XG4gIGNvbnN0IHJvb3RDbGFzc05hbWUgPSB1c2VTdHlsZVRvRW1vdGlvbk9iamVjdCgpKFJPT1RfU1RZTEUpICsgJyc7XG5cbiAgY29uc3QgdHJhbnNjcmlwdFJvbGVEZXNjcmlwdGlvbiA9IGxvY2FsaXplKCdUUkFOU0NSSVBUX0FSSUFfUk9MRV9BTFQnKTtcblxuICByZXR1cm4gKFxuICAgIDxMaXZlUmVnaW9uVHdpbkNvbXBvc2VyXG4gICAgICBhcmlhLXJvbGVkZXNjcmlwdGlvbj17dHJhbnNjcmlwdFJvbGVEZXNjcmlwdGlvbn1cbiAgICAgIGNsYXNzTmFtZT17Y2xhc3NOYW1lcygnd2ViY2hhdF9fbGl2ZS1yZWdpb24tdHJhbnNjcmlwdCcsIHJvb3RDbGFzc05hbWUpfVxuICAgICAgZmFkZUFmdGVyPXtpbnRlcm5hbExpdmVSZWdpb25GYWRlQWZ0ZXJ9XG4gICAgICByb2xlPVwibG9nXCJcbiAgICAgIHRleHRFbGVtZW50Q2xhc3NOYW1lPVwid2ViY2hhdF9fbGl2ZS1yZWdpb24tdHJhbnNjcmlwdF9fdGV4dC1lbGVtZW50XCJcbiAgICA+XG4gICAgICA8TGl2ZVJlZ2lvblRyYW5zY3JpcHRDb3JlIGFjdGl2aXR5RWxlbWVudE1hcFJlZj17YWN0aXZpdHlFbGVtZW50TWFwUmVmfSAvPlxuICAgIDwvTGl2ZVJlZ2lvblR3aW5Db21wb3Nlcj5cbiAgKTtcbn07XG5cbkxpdmVSZWdpb25UcmFuc2NyaXB0LnByb3BUeXBlcyA9IHtcbiAgLy8gUHJvcFR5cGVzIGNhbm5vdCBiZSBmdWxseSBleHByZXNzZWQgaW4gVHlwZVNjcmlwdC5cbiAgLy8gQHRzLWlnbm9yZVxuICBhY3Rpdml0eUVsZW1lbnRNYXBSZWY6IFByb3BUeXBlcy5zaGFwZSh7XG4gICAgY3VycmVudDogUHJvcFR5cGVzLmluc3RhbmNlT2YoTWFwKVxuICB9KS5pc1JlcXVpcmVkXG59O1xuXG5l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